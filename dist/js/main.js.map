{"version":3,"sources":["main.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","obj","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_idb","_idb2","__esModule","default","DBHelper","instance","TypeError","_classCallCheck","this","_IDB","openDatabase","get","navigator","serviceWorker","open","upgradedDB","oldVersion","createObjectStore","keyPath","createIndex","console","log","Promise","resolve","restaurants","arguments","undefined","then","db","tx","transaction","readwriteStore","objectStore","forEach","restaurant","put","complete","index","getAll","rreview","callback","_this","loadCache","data","fetch","DATABASE_URL","response","status","json","cacheData","handleResponseError","catch","error","id","fetchRestaurants","find","cuisine","results","filter","cuisine_type","neighborhood","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","size","img","photograph","google","maps","Marker","position","latlng","title","name","url","urlForRestaurant","animation","Animation","DROP","type","idb","2","Main","_mainController2","_interopRequireDefault","controller","document","querySelector","fetchNeighborhoods","fetchCuisines","window","initMap","self","Map","getElementById","zoom","center","lat","lng","scrollwheel","updateRestaurants","cSelect","nSelect","cIndex","selectedIndex","nIndex","addEventListener","event","main","./dbhelper","./mainController","3","MainController","_dbhelper2","_util2","container","markers","_container","_registerServiceWorker","handleError","snackbar","message","register","scope","swReg","err","setTimeout","onLine","fetchRestaurantByCuisineAndNeighborhood","resetRestaurants","fillRestaurantsHTML","_this2","fillNeighborhoodsHTML","select","option","createElement","innerHTML","append","_this3","fillCuisinesHTML","m","setMap","_this4","ul","createRestaurantHTML","addMarkersToMap","li","setAttribute","address","image","className","src","imageUrlForRestaurant","alt","srcset","more","href","_this5","marker","mapMarkerForRestaurant","addListener","location","push","./util","4","Util","el","color","style","visibility","background","5","promisifyRequest","request","reject","onsuccess","result","onerror","promisifyRequestCall","method","args","apply","proxyProperties","ProxyClass","targetProp","properties","prop","set","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Cursor","Index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","replace","arr","Array","slice","nativeObject","query","count","items","iterateCursor","continue","exp","version","upgradeCallback","indexedDB","onupgradeneeded","delete"],"mappings":"CAAA,WAA+b,OAAnb,SAASA,EAAEC,EAAEC,EAAEC,GAAG,SAASC,EAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,IAAIE,EAAE,mBAAmBC,SAASA,QAAQ,IAAIF,GAAGC,EAAE,OAAOA,EAAEF,GAAE,GAAI,GAAGI,EAAE,OAAOA,EAAEJ,GAAE,GAAI,IAAIK,EAAE,IAAIC,MAAM,uBAAuBN,EAAE,KAAK,MAAMK,EAAEE,KAAK,mBAAmBF,EAAE,IAAIG,EAAEX,EAAEG,GAAG,CAACS,QAAQ,IAAIb,EAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAoB,OAAOI,EAAlBH,EAAEI,GAAG,GAAGL,IAAeA,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,OAAOD,EAAEG,GAAGS,QAAQ,IAAI,IAAIL,EAAE,mBAAmBD,SAASA,QAAQH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,IAAI,OAAOD,GAA7b,EAAA,CAA4c,CAACa,EAAE,CAAC,SAAST,EAAQU,EAAOJ,GACxe,aAEAK,OAAOC,eAAeN,EAAS,aAAc,CAC5CO,OAAO,IAGR,IAMgCC,EAN5BC,EAAe,WAAc,SAASC,EAAiBC,EAAQC,GAAS,IAAK,IAAIrB,EAAI,EAAGA,EAAIqB,EAAMV,OAAQX,IAAK,CAAE,IAAIsB,EAAaD,EAAMrB,GAAIsB,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,UAAWF,IAAYA,EAAWG,UAAW,GAAMX,OAAOC,eAAeK,EAAQE,EAAWI,IAAKJ,IAAiB,OAAO,SAAUK,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYT,EAAiBQ,EAAYG,UAAWF,GAAiBC,GAAaV,EAAiBQ,EAAaE,GAAqBF,GAA7gB,GAEfI,EAAO5B,EAAQ,OAEf6B,GAE4Bf,EAFGc,IAEkBd,EAAIgB,WAAahB,EAAM,CAAEiB,QAASjB,GAOvF,IAAIkB,EAAW,WAed,SAASA,KApBV,SAAyBC,EAAUT,GAAe,KAAMS,aAAoBT,GAAgB,MAAM,IAAIU,UAAU,qCAqB9GC,CAAgBC,KAAMJ,GAEtBI,KAAKC,KAAOD,KAAKE,eAuRlB,OAxSAvB,EAAaiB,EAAU,CAAC,CACvBT,IAAK,eAOLgB,IAAK,WAEJ,MAAO,wCAUTxB,EAAaiB,EAAU,CAAC,CACvBT,IAAK,eACLV,MAAO,WACN,OAAK2B,UAAUC,cAERZ,EAAME,QAAQW,KAAK,UAAW,EAAG,SAAUC,GACjD,OAAQA,EAAWC,YAClB,KAAK,EACUD,EAAWE,kBAAkB,UAAW,CAAEC,QAAS,OAC7CC,YAAY,QAAS,MACzCC,QAAQC,IAAI,iCAPsBC,QAAQC,YAW5C,CACF5B,IAAK,YACLV,MAAO,WACN,IAAIuC,EAAcC,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,GAGtFjB,KAAKC,KAAKkB,KAAK,SAAUC,GACxB,GAAKA,EAAL,CAEA,IAAIC,EAAKD,EAAGE,YAAY,UAAW,aAC/BC,EAAiBF,EAAGG,YAAY,WACpCR,EAAYS,QAAQ,SAAUC,GAC7B,OAAOH,EAAeI,IAAID,KAE3BL,EAAGO,SAAST,KAAK,WAChB,OAAOP,QAAQC,IAAI,kCASpB,CACF1B,IAAK,YACLV,MAAO,WACN,OAAOuB,KAAKC,KAAKkB,KAAK,SAAUC,GAC/B,GAAKA,EACL,OAAOA,EAAGE,YAAY,WAAWE,YAAY,WAAWK,MAAM,SAASC,WACrEX,KAAK,SAAUY,GACjB,OAAOA,MAGP,CACF5C,IAAK,mBAULV,MAAO,SAA0BuD,GAChC,IAAIC,EAAQjC,KAEZA,KAAKkC,YAAYf,KAAK,SAAUgB,GAC3BA,EAAK/D,OAAS,EACjB4D,EAAS,KAAMG,GAGfC,MAAMH,EAAMI,cAAclB,KAAK,SAAUmB,GAChB,MAApBA,EAASC,OACZD,EAASE,OAAOrB,KAAK,SAAUgB,GAC9BF,EAAMQ,UAAUN,GAChBH,EAAS,KAAMG,GACfvB,QAAQC,IAAI,qCAGbmB,EAASC,EAAMS,oBAAoBJ,EAAU,eAAgB,QAE5DK,MAAM,SAAUC,GAClB,OAAOZ,EAASY,EAAO,YASzB,CACFzD,IAAK,sBACLV,MAAO,SAA6BoE,EAAIb,GAEvChC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GAEtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CAEN,IAAIlB,EAAaV,EAAY+B,KAAK,SAAU3F,GAC3C,OAAOA,EAAEyF,IAAMA,IAGZnB,EAEHM,EAAS,KAAMN,GAGfM,EAAS,4BAA6B,WASxC,CACF7C,IAAK,2BACLV,MAAO,SAAkCuE,EAAShB,GAEjDhC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GACtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CAEN,IAAIK,EAAUjC,EAAYkC,OAAO,SAAU9F,GAC1C,OAAOA,EAAE+F,cAAgBH,IAE1BhB,EAAS,KAAMiB,QAQhB,CACF9D,IAAK,gCACLV,MAAO,SAAuC2E,EAAcpB,GAE3DhC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GACtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CAEN,IAAIK,EAAUjC,EAAYkC,OAAO,SAAU9F,GAC1C,OAAOA,EAAEgG,cAAgBA,IAE1BpB,EAAS,KAAMiB,QAQhB,CACF9D,IAAK,0CACLV,MAAO,SAAiDuE,EAASI,EAAcpB,GAE9EhC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GACtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CACN,IAAIK,EAAUjC,EACC,OAAXgC,IAEHC,EAAUA,EAAQC,OAAO,SAAU9F,GAClC,OAAOA,EAAE+F,cAAgBH,KAGP,OAAhBI,IAEHH,EAAUA,EAAQC,OAAO,SAAU9F,GAClC,OAAOA,EAAEgG,cAAgBA,KAG3BpB,EAAS,KAAMiB,QAQhB,CACF9D,IAAK,qBACLV,MAAO,SAA4BuD,GAElChC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GACtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CAEN,IAAIS,EAAgBrC,EAAYsC,IAAI,SAAUC,EAAG9F,GAChD,OAAOuD,EAAYvD,GAAG2F,eAGnBI,EAAsBH,EAAcH,OAAO,SAAUK,EAAG9F,GAC3D,OAAO4F,EAAcI,QAAQF,IAAM9F,IAEpCuE,EAAS,KAAMwB,QAQhB,CACFrE,IAAK,gBACLV,MAAO,SAAuBuD,GAE7BhC,KAAK8C,iBAAiB,SAAUF,EAAO5B,GACtC,GAAI4B,EACHZ,EAASY,EAAO,UACV,CAEN,IAAIc,EAAW1C,EAAYsC,IAAI,SAAUC,EAAG9F,GAC3C,OAAOuD,EAAYvD,GAAG0F,eAGnBQ,EAAiBD,EAASR,OAAO,SAAUK,EAAG9F,GACjD,OAAOiG,EAASD,QAAQF,IAAM9F,IAE/BuE,EAAS,KAAM2B,QAQhB,CACFxE,IAAK,mBACLV,MAAO,SAA0BiD,GAChC,MAAO,wBAA0BA,EAAWmB,KAM3C,CACF1D,IAAK,wBACLV,MAAO,SAA+BiD,EAAYkC,GACjD,IAAIC,EAAMnC,EAAWoC,WACrB,OAAOD,EAAM,QAAUA,EAAM,IAAMD,EAAO,OAAS,oCAMlD,CACFzE,IAAK,yBACLV,MAAO,SAAgCiD,EAAY4B,GAOlD,OANa,IAAIS,OAAOC,KAAKC,OAAO,CACnCC,SAAUxC,EAAWyC,OACrBC,MAAO1C,EAAW2C,KAClBC,IAAKtE,KAAKuE,iBAAiB7C,GAC3B4B,IAAKA,EACLkB,UAAWT,OAAOC,KAAKS,UAAUC,SAGjC,CACFvF,IAAK,sBACLV,MAAO,SAA6B6D,EAAUqC,GAC7C,OAAQrC,EAASC,QAChB,KAAK,IACJ,OAAO,IAAIxE,MAAM,eAClB,KAAK,IACJ,OAAO,IAAIA,MAAM,aAClB,KAAK,IACJ,OAAO,IAAIA,MAAM,8BAKd6B,EAzSO,GA4Sf1B,EAAQyB,QAAUC,GAEhB,CAACgF,IAAM,IAAIC,EAAE,CAAC,SAASjH,EAAQU,EAAOJ,GACxC,aAEAK,OAAOC,eAAeN,EAAS,aAAc,CAC5CO,OAAO,IAERP,EAAQ4G,KAAOA,EAEf,IAEIC,EAAmBC,EAFDpH,EAAQ,qBAMboH,EAFDpH,EAAQ,eAIxB,SAASoH,EAAuBtG,GAAO,OAAOA,GAAOA,EAAIgB,WAAahB,EAAM,CAAEiB,QAASjB,GAIvF,SAASoG,IACR,IAAI7C,EAAQjC,KAKZA,KAAKiF,WAAa,IAAIF,EAAiBpF,QAAQuF,SAASC,cAAc,cAEtEnF,KAAKiF,WAAWG,qBAChBpF,KAAKiF,WAAWI,gBAKhBC,OAAOC,QAAU,WAKhBC,KAAKlC,IAAM,IAAIS,OAAOC,KAAKyB,IAAIP,SAASQ,eAAe,OAAQ,CAC9DC,KAAM,GACNC,OANS,CACTC,IAAK,UACLC,KAAM,WAKNC,aAAa,IAEd9D,EAAM+D,qBAIRlB,EAAKvF,UAAUyG,kBAAoB,WAElC,IAAIC,EAAUf,SAASQ,eAAe,mBAClCQ,EAAUhB,SAASQ,eAAe,wBAElCS,EAASF,EAAQG,cACjBC,EAASH,EAAQE,cAEjBpD,EAAUiD,EAAQE,GAAQ1H,MAC1B2E,EAAe8C,EAAQG,GAAQ5H,MAEnCuB,KAAKiF,WAAWnC,iBAAiBE,EAASI,IAG3C8B,SAASoB,iBAAiB,mBAAoB,SAAUC,GACvDjB,OAAOkB,KAAO,IAAI1B,KAGjB,CAAC2B,aAAa,EAAEC,mBAAmB,IAAIC,EAAE,CAAC,SAAS/I,EAAQU,EAAOJ,GACpE,aAEAK,OAAOC,eAAeN,EAAS,aAAc,CAC5CO,OAAO,IAERP,EAAQyB,QAAUiH,EAElB,IAEIC,EAAa7B,EAFDpH,EAAQ,eAMpBkJ,EAAS9B,EAFDpH,EAAQ,WAIpB,SAASoH,EAAuBtG,GAAO,OAAOA,GAAOA,EAAIgB,WAAahB,EAAM,CAAEiB,QAASjB,GAEvF,SAASkI,EAAeG,GAIvB/G,KAAKgH,QAAU,GACfhH,KAAKiH,WAAaF,EAClB/G,KAAKkH,yBAELlH,KAAKoB,GAAK,IAAIyF,EAAWlH,QA+L1B,SAASwH,EAAYvE,GACpBkE,EAAOnH,QAAQyH,SAASlC,SAASC,cAAc,aAAcvC,EAAMyE,SA7LpET,EAAerH,UAAU2H,uBAAyB,WAEjD,GAAI9G,UAAUC,cAAe,CAE5B,GAAID,UAAUC,cAAc4E,WAAY,OAExC7E,UAAUC,cAAciH,SAAS,SAAU,CAAEC,MAAO,KAAMpG,KAAK,SAAUqG,GACxE5G,QAAQC,IAAI,kDAAmD2G,EAAMD,SACnE5E,MAAM,SAAU8E,GAClB7G,QAAQC,IAAI,oCAAqC4G,EAAIJ,WAIhCK,WAAW,WAC3BtH,UAAUuH,QAAQR,EAAY,IAAIpJ,MAAM,mBAC3C,OAIL6I,EAAerH,UAAUuD,iBAAmB,SAAUE,EAASI,GAC9D,IAAInB,EAAQjC,KAEZA,KAAKoB,GAAGwG,wCAAwC5E,EAASI,EAAc,SAAUR,EAAO5B,GACvF,IAAI4B,EAMH,OAFAX,EAAM4F,iBAAiB7G,GACvBiB,EAAM6F,sBACC9G,EAJPmG,EAAYvE,MAYfgE,EAAerH,UAAU6F,mBAAqB,WAC7C,IAAI2C,EAAS/H,KAEbA,KAAKoB,GAAGgE,mBAAmB,SAAUxC,EAAOS,GACvCT,EAEHuE,EAAYvE,IAEZmF,EAAO1E,cAAgBA,EACvB0E,EAAOC,4BAQVpB,EAAerH,UAAUyI,sBAAwB,WAChD,IAAI3E,EAAgBpC,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAKjB,KAAKqD,cAEzF4E,EAAS/C,SAASQ,eAAe,wBACrCrC,EAAc5B,QAAQ,SAAU2B,GAC/B,IAAI8E,EAAShD,SAASiD,cAAc,UACpCD,EAAOE,UAAYhF,EACnB8E,EAAOzJ,MAAQ2E,EACf6E,EAAOI,OAAOH,MAOhBtB,EAAerH,UAAU8F,cAAgB,WACxC,IAAIiD,EAAStI,KAEbA,KAAKoB,GAAGiE,cAAc,SAAUzC,EAAOc,GAClCd,EAEHuE,EAAYvE,IAEZ0F,EAAO5E,SAAWA,EAClB4E,EAAOC,uBAQV3B,EAAerH,UAAUgJ,iBAAmB,WAC3C,IAAI7E,EAAWzC,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAKjB,KAAK0D,SAEpFuE,EAAS/C,SAASQ,eAAe,mBACrChC,EAASjC,QAAQ,SAAUuB,GAC1B,IAAIkF,EAAShD,SAASiD,cAAc,UACpCD,EAAOE,UAAYpF,EACnBkF,EAAOzJ,MAAQuE,EACfiF,EAAOI,OAAOH,MAOhBtB,EAAerH,UAAUsI,iBAAmB,SAAU7G,GAErDhB,KAAKgB,YAAc,GACVkE,SAASQ,eAAe,oBAC9B0C,UAAY,GAGfpI,KAAKgH,QAAQvF,QAAQ,SAAU+G,GAC9B,OAAOA,EAAEC,OAAO,QAEjBzI,KAAKgH,QAAU,GACfhH,KAAKgB,YAAcA,GAMpB4F,EAAerH,UAAUuI,oBAAsB,WAC9C,IAAIY,EAAS1I,KAETgB,EAAcC,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAKjB,KAAKgB,YAEvF2H,EAAKzD,SAASQ,eAAe,oBACjC1E,EAAYS,QAAQ,SAAUC,GAC7BiH,EAAGN,OAAOK,EAAOE,qBAAqBlH,MAEvC1B,KAAK6I,mBAMNjC,EAAerH,UAAUqJ,qBAAuB,SAAUlH,GAEzD,IAAIoH,EAAK5D,SAASiD,cAAc,MAChCW,EAAGC,aAAa,aAAcrH,EAAW2C,KAAO,MAAQ3C,EAAWyB,aAAe,MAAQzB,EAAWsH,SAErG,IAAIC,EAAQ/D,SAASiD,cAAc,OACnCc,EAAMC,UAAY,iBAClBD,EAAME,IAAMnJ,KAAKoB,GAAGgI,sBAAsB1H,EAAY,KACtDuH,EAAMI,IAAM,YAAc3H,EAAW2C,KAAO,cAC5C4E,EAAMK,OAAStJ,KAAKoB,GAAGgI,sBAAsB1H,EAAY,MAAQ,WAAa1B,KAAKoB,GAAGgI,sBAAsB1H,EAAY,KAAO,QAE/HoH,EAAGT,OAAOY,GAEV,IAAI5E,EAAOa,SAASiD,cAAc,MAClC9D,EAAK+D,UAAY1G,EAAW2C,KAC5ByE,EAAGT,OAAOhE,GAEV,IAAIjB,EAAe8B,SAASiD,cAAc,KAC1C/E,EAAagF,UAAY1G,EAAW0B,aACpC0F,EAAGT,OAAOjF,GAEV,IAAI4F,EAAU9D,SAASiD,cAAc,KACrCa,EAAQZ,UAAY1G,EAAWsH,QAC/BF,EAAGT,OAAOW,GAEV,IAAIO,EAAOrE,SAASiD,cAAc,KASlC,OARAoB,EAAKnB,UAAY,eACjBmB,EAAKC,KAAOxJ,KAAKoB,GAAGmD,iBAAiB7C,GACrCoH,EAAGT,OAAOkB,GAMHT,GAMRlC,EAAerH,UAAUsJ,gBAAkB,WAC1C,IAAIY,EAASzJ,MAEKiB,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAKjB,KAAKgB,aAE/ES,QAAQ,SAAUC,GAE7B,IAAIgI,EAASD,EAAOrI,GAAGuI,uBAAuBjI,EAAY8D,KAAKlC,KAC/DS,OAAOC,KAAKuC,MAAMqD,YAAYF,EAAQ,QAAS,WAC9CpE,OAAOuE,SAASL,KAAOE,EAAOpF,MAE/BmF,EAAOzC,QAAQ8C,KAAKJ,OAQpB,CAACjD,aAAa,EAAEsD,SAAS,IAAIC,EAAE,CAAC,SAASpM,EAAQU,EAAOJ,GAC1D,aAEAK,OAAOC,eAAeN,EAAS,aAAc,CAC5CO,OAAO,IAGR,IAAIE,EAAe,WAAc,SAASC,EAAiBC,EAAQC,GAAS,IAAK,IAAIrB,EAAI,EAAGA,EAAIqB,EAAMV,OAAQX,IAAK,CAAE,IAAIsB,EAAaD,EAAMrB,GAAIsB,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,UAAWF,IAAYA,EAAWG,UAAW,GAAMX,OAAOC,eAAeK,EAAQE,EAAWI,IAAKJ,IAAiB,OAAO,SAAUK,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYT,EAAiBQ,EAAYG,UAAWF,GAAiBC,GAAaV,EAAiBQ,EAAaE,GAAqBF,GAA7gB,GAOnB,IAAI6K,EAAO,WACV,SAASA,KANV,SAAyBpK,EAAUT,GAAe,KAAMS,aAAoBT,GAAgB,MAAM,IAAIU,UAAU,qCAO9GC,CAAgBC,KAAMiK,GA2BvB,OAxBAtL,EAAasL,EAAM,KAAM,CAAC,CACzB9K,IAAK,WACLV,MAAO,SAAkByL,EAAI7C,GAC5B,IAAI8C,EAAQlJ,UAAU7C,OAAS,QAAsB8C,IAAjBD,UAAU,GAAmBA,UAAU,GAAK,UAOhF,IAAKiJ,EAEJ,OADAtJ,QAAQC,IAAI,IAAI9C,MAAM,gCACf,EAGRmM,EAAG9B,UAAYf,EACf6C,EAAGE,MAAMC,WAAa,UACtBH,EAAGE,MAAME,WAAaH,EACtBzC,WAAW,WACVwC,EAAGE,MAAMC,WAAa,UACpB,UAIEJ,EA7BG,GAgCX/L,EAAQyB,QAAUsK,GAEhB,IAAIM,EAAE,CAAC,SAAS3M,EAAQU,EAAOJ,GACjC,cAEC,WAKC,SAASsM,EAAiBC,GACxB,OAAO,IAAI3J,QAAQ,SAASC,EAAS2J,GACnCD,EAAQE,UAAY,WAClB5J,EAAQ0J,EAAQG,SAGlBH,EAAQI,QAAU,WAChBH,EAAOD,EAAQ7H,UAKrB,SAASkI,EAAqBpM,EAAKqM,EAAQC,GACzC,IAAIP,EACAxM,EAAI,IAAI6C,QAAQ,SAASC,EAAS2J,GAEpCF,EADAC,EAAU/L,EAAIqM,GAAQE,MAAMvM,EAAKsM,IACP7J,KAAKJ,EAAS2J,KAI1C,OADAzM,EAAEwM,QAAUA,EACLxM,EAWT,SAASiN,EAAgBC,EAAYC,EAAYC,GAC/CA,EAAW5J,QAAQ,SAAS6J,GAC1B/M,OAAOC,eAAe2M,EAAW5L,UAAW+L,EAAM,CAChDnL,IAAK,WACH,OAAOH,KAAKoL,GAAYE,IAE1BC,IAAK,SAASC,GACZxL,KAAKoL,GAAYE,GAAQE,OAMjC,SAASC,EAAoBN,EAAYC,EAAYhM,EAAaiM,GAChEA,EAAW5J,QAAQ,SAAS6J,GACpBA,KAAQlM,EAAYG,YAC1B4L,EAAW5L,UAAU+L,GAAQ,WAC3B,OAAOR,EAAqB9K,KAAKoL,GAAaE,EAAMrK,eAK1D,SAASyK,EAAaP,EAAYC,EAAYhM,EAAaiM,GACzDA,EAAW5J,QAAQ,SAAS6J,GACpBA,KAAQlM,EAAYG,YAC1B4L,EAAW5L,UAAU+L,GAAQ,WAC3B,OAAOtL,KAAKoL,GAAYE,GAAML,MAAMjL,KAAKoL,GAAanK,eAK5D,SAAS0K,EAA0BR,EAAYC,EAAYhM,EAAaiM,GACtEA,EAAW5J,QAAQ,SAAS6J,GACpBA,KAAQlM,EAAYG,YAC1B4L,EAAW5L,UAAU+L,GAAQ,WAC3B,OA3C8B5M,EA2CIsB,KAAKoL,IA1CvCnN,EAAI6M,EAAqBpM,EA0C2B4M,EAAMrK,YAzCrDE,KAAK,SAAS1C,GACrB,GAAKA,EACL,OAAO,IAAImN,EAAOnN,EAAOR,EAAEwM,WAJ/B,IAAoC/L,EAC9BT,MA+CN,SAAS4N,EAAMhK,GACb7B,KAAK8L,OAASjK,EAuBhB,SAAS+J,EAAOG,EAAQtB,GACtBzK,KAAKgM,QAAUD,EACf/L,KAAKiM,SAAWxB,EA+BlB,SAASyB,EAAYC,GACnBnM,KAAKoM,OAASD,EAuChB,SAASE,EAAYC,GACnBtM,KAAKuM,IAAMD,EACXtM,KAAK4B,SAAW,IAAId,QAAQ,SAASC,EAAS2J,GAC5C4B,EAAeE,WAAa,WAC1BzL,KAEFuL,EAAezB,QAAU,WACvBH,EAAO4B,EAAe1J,QAExB0J,EAAeG,QAAU,WACvB/B,EAAO4B,EAAe1J,UAkB5B,SAAS8J,EAAUtL,EAAIZ,EAAYc,GACjCtB,KAAK2M,IAAMvL,EACXpB,KAAKQ,WAAaA,EAClBR,KAAKsB,YAAc,IAAI+K,EAAY/K,GAkBrC,SAASsL,EAAGxL,GACVpB,KAAK2M,IAAMvL,EA/Ib8J,EAAgBW,EAAO,SAAU,CAC/B,OACA,UACA,aACA,WAGFJ,EAAoBI,EAAO,SAAUgB,SAAU,CAC7C,MACA,SACA,SACA,aACA,UAGFlB,EAA0BE,EAAO,SAAUgB,SAAU,CACnD,aACA,kBAQF3B,EAAgBU,EAAQ,UAAW,CACjC,YACA,MACA,aACA,UAGFH,EAAoBG,EAAQ,UAAWkB,UAAW,CAChD,SACA,WAIF,CAAC,UAAW,WAAY,sBAAsBrL,QAAQ,SAASsL,GACvDA,KAAcD,UAAUvN,YAC9BqM,EAAOrM,UAAUwN,GAAc,WAC7B,IAAIhB,EAAS/L,KACTgL,EAAO/J,UACX,OAAOH,QAAQC,UAAUI,KAAK,WAE5B,OADA4K,EAAOC,QAAQe,GAAY9B,MAAMc,EAAOC,QAAShB,GAC1CR,EAAiBuB,EAAOE,UAAU9K,KAAK,SAAS1C,GACrD,GAAKA,EACL,OAAO,IAAImN,EAAOnN,EAAOsN,EAAOE,kBAUxCC,EAAY3M,UAAUoB,YAAc,WAClC,OAAO,IAAIkL,EAAM7L,KAAKoM,OAAOzL,YAAYsK,MAAMjL,KAAKoM,OAAQnL,aAG9DiL,EAAY3M,UAAUsC,MAAQ,WAC5B,OAAO,IAAIgK,EAAM7L,KAAKoM,OAAOvK,MAAMoJ,MAAMjL,KAAKoM,OAAQnL,aAGxDiK,EAAgBgB,EAAa,SAAU,CACrC,OACA,UACA,aACA,kBAGFT,EAAoBS,EAAa,SAAUc,eAAgB,CACzD,MACA,MACA,SACA,QACA,MACA,SACA,SACA,aACA,UAGFrB,EAA0BO,EAAa,SAAUc,eAAgB,CAC/D,aACA,kBAGFtB,EAAaQ,EAAa,SAAUc,eAAgB,CAClD,gBAkBFX,EAAY9M,UAAUiC,YAAc,WAClC,OAAO,IAAI0K,EAAYlM,KAAKuM,IAAI/K,YAAYyJ,MAAMjL,KAAKuM,IAAKtL,aAG9DiK,EAAgBmB,EAAa,MAAO,CAClC,mBACA,SAGFX,EAAaW,EAAa,MAAOY,eAAgB,CAC/C,UASFP,EAAUnN,UAAUkB,kBAAoB,WACtC,OAAO,IAAIyL,EAAYlM,KAAK2M,IAAIlM,kBAAkBwK,MAAMjL,KAAK2M,IAAK1L,aAGpEiK,EAAgBwB,EAAW,MAAO,CAChC,OACA,UACA,qBAGFhB,EAAagB,EAAW,MAAOQ,YAAa,CAC1C,oBACA,UAOFN,EAAGrN,UAAU+B,YAAc,WACzB,OAAO,IAAI+K,EAAYrM,KAAK2M,IAAIrL,YAAY2J,MAAMjL,KAAK2M,IAAK1L,aAG9DiK,EAAgB0B,EAAI,MAAO,CACzB,OACA,UACA,qBAGFlB,EAAakB,EAAI,MAAOM,YAAa,CACnC,UAKF,CAAC,aAAc,iBAAiBzL,QAAQ,SAAS0L,GAC/C,CAACjB,EAAaL,GAAOpK,QAAQ,SAASrC,GAE9B+N,KAAY/N,EAAYG,YAE9BH,EAAYG,UAAU4N,EAASC,QAAQ,OAAQ,YAAc,WAC3D,IAvPWC,EAuPPrC,GAvPOqC,EAuPQpM,UAtPhBqM,MAAM/N,UAAUgO,MAAMpP,KAAKkP,IAuP1BrL,EAAWgJ,EAAKA,EAAK5M,OAAS,GAC9BoP,EAAexN,KAAKoM,QAAUpM,KAAK8L,OACnCrB,EAAU+C,EAAaL,GAAUlC,MAAMuC,EAAcxC,EAAKuC,MAAM,GAAI,IACxE9C,EAAQE,UAAY,WAClB3I,EAASyI,EAAQG,eAOzB,CAACiB,EAAOK,GAAazK,QAAQ,SAASrC,GAChCA,EAAYG,UAAUuC,SAC1B1C,EAAYG,UAAUuC,OAAS,SAAS2L,EAAOC,GAC7C,IAAI7N,EAAWG,KACX2N,EAAQ,GAEZ,OAAO,IAAI7M,QAAQ,SAASC,GAC1BlB,EAAS+N,cAAcH,EAAO,SAAS1B,GAChCA,GAIL4B,EAAM7D,KAAKiC,EAAOtN,YAEJyC,IAAVwM,GAAuBC,EAAMvP,QAAUsP,EAI3C3B,EAAO8B,WAHL9M,EAAQ4M,IANR5M,EAAQ4M,WAelB,IAAIG,EAAM,CACRxN,KAAM,SAAS+D,EAAM0J,EAASC,GAC5B,IAAI/P,EAAI6M,EAAqBmD,UAAW,OAAQ,CAAC5J,EAAM0J,IACnDtD,EAAUxM,EAAEwM,QAUhB,OARIA,IACFA,EAAQyD,gBAAkB,SAAS3H,GAC7ByH,GACFA,EAAgB,IAAItB,EAAUjC,EAAQG,OAAQrE,EAAM/F,WAAYiK,EAAQnJ,gBAKvErD,EAAEkD,KAAK,SAASC,GACrB,OAAO,IAAIwL,EAAGxL,MAGlB+M,OAAQ,SAAS9J,GACf,OAAOyG,EAAqBmD,UAAW,iBAAkB,CAAC5J,WAIxC,IAAX/F,GACTA,EAAOJ,QAAU4P,EACjBxP,EAAOJ,QAAQyB,QAAUrB,EAAOJ,SAGhCsH,KAAKZ,IAAMkJ,EAvTf,IA2TE,KAAK,GAAG,CAAC","file":"main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _idb = require('idb');\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* Common database helper functions.\n*/\nvar DBHelper = function () {\n\t_createClass(DBHelper, [{\n\t\tkey: 'DATABASE_URL',\n\n\n\t\t/**\n   * Database URL.\n   * Change this to restaurants.json file location on your server.\n   */\n\t\tget: function get() {\n\t\t\tvar port = 1337; // Change this to your server port\n\t\t\treturn 'http://localhost:' + port + '/restaurants';\n\t\t}\n\t}]);\n\n\tfunction DBHelper() {\n\t\t_classCallCheck(this, DBHelper);\n\n\t\tthis._IDB = this.openDatabase();\n\t}\n\n\t_createClass(DBHelper, [{\n\t\tkey: 'openDatabase',\n\t\tvalue: function openDatabase() {\n\t\t\tif (!navigator.serviceWorker) return Promise.resolve();\n\n\t\t\treturn _idb2.default.open('rreview', 1, function (upgradedDB) {\n\t\t\t\tswitch (upgradedDB.oldVersion) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tvar rreview = upgradedDB.createObjectStore('rreview', { keyPath: 'id' });\n\t\t\t\t\t\tvar index = rreview.createIndex('by-id', 'id');\n\t\t\t\t\t\tconsole.log('Database and Index created');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'cacheData',\n\t\tvalue: function cacheData() {\n\t\t\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n\t\t\t// add post the local DB\n\t\t\tthis._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\n\t\t\t\tvar tx = db.transaction('rreview', 'readwrite');\n\t\t\t\tvar readwriteStore = tx.objectStore('rreview');\n\t\t\t\trestaurants.forEach(function (restaurant) {\n\t\t\t\t\treturn readwriteStore.put(restaurant);\n\t\t\t\t});\n\t\t\t\ttx.complete.then(function () {\n\t\t\t\t\treturn console.log('post added to indexedDB');\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n  * Load data from the client database.\n  */\n\n\t}, {\n\t\tkey: 'loadCache',\n\t\tvalue: function loadCache() {\n\t\t\treturn this._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\t\t\t\treturn db.transaction('rreview').objectStore('rreview').index('by-id').getAll();\n\t\t\t}).then(function (rreview) {\n\t\t\t\treturn rreview;\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'fetchRestaurants',\n\n\n\t\t/** TODO\n  * Implement Socket to load real times database loads\n  */\n\n\t\t/**\n   * Fetch all restaurants.\n   */\n\t\tvalue: function fetchRestaurants(callback) {\n\t\t\tvar _this = this;\n\n\t\t\tthis.loadCache().then(function (data) {\n\t\t\t\tif (data.length > 0) {\n\t\t\t\t\tcallback(null, data);\n\t\t\t\t} else {\n\n\t\t\t\t\tfetch(_this.DATABASE_URL).then(function (response) {\n\t\t\t\t\t\tif (response.status === 200) {\n\t\t\t\t\t\t\tresponse.json().then(function (data) {\n\t\t\t\t\t\t\t\t_this.cacheData(data);\n\t\t\t\t\t\t\t\tcallback(null, data);\n\t\t\t\t\t\t\t\tconsole.log('data loaded from local storage!');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback(_this.handleResponseError(response, 'api request'), null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(function (error) {\n\t\t\t\t\t\treturn callback(error, null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch a restaurant by its ID.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantById',\n\t\tvalue: function fetchRestaurantById(id, callback) {\n\t\t\t// fetch all restaurants with proper error handling.\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\n\t\t\t\t\tvar restaurant = restaurants.find(function (r) {\n\t\t\t\t\t\treturn r.id == id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (restaurant) {\n\t\t\t\t\t\t// Got the restaurant\n\t\t\t\t\t\tcallback(null, restaurant);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Restaurant does not exist in the database\n\t\t\t\t\t\tcallback('Restaurant does not exist', null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine type with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisine',\n\t\tvalue: function fetchRestaurantByCuisine(cuisine, callback) {\n\t\t\t// Fetch all restaurants\twith proper error handling\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given cuisine type\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByNeighborhood',\n\t\tvalue: function fetchRestaurantByNeighborhood(neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given neighborhood\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisineAndNeighborhood',\n\t\tvalue: function fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\tvar results = restaurants;\n\t\t\t\t\tif (cuisine != 'all') {\n\t\t\t\t\t\t// filter by cuisine\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (neighborhood != 'all') {\n\t\t\t\t\t\t// filter by neighborhood\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all neighborhoods with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchNeighborhoods',\n\t\tvalue: function fetchNeighborhoods(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all neighborhoods from all restaurants\n\t\t\t\t\tvar neighborhoods = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from neighborhoods\n\t\t\t\t\tvar uniqueNeighborhoods = neighborhoods.filter(function (v, i) {\n\t\t\t\t\t\treturn neighborhoods.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueNeighborhoods);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all cuisines with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchCuisines',\n\t\tvalue: function fetchCuisines(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all cuisines from all restaurants\n\t\t\t\t\tvar cuisines = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].cuisine_type;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from cuisines\n\t\t\t\t\tvar uniqueCuisines = cuisines.filter(function (v, i) {\n\t\t\t\t\t\treturn cuisines.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueCuisines);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Restaurant page URL.\n   */\n\n\t}, {\n\t\tkey: 'urlForRestaurant',\n\t\tvalue: function urlForRestaurant(restaurant) {\n\t\t\treturn './restaurant.html?id=' + restaurant.id;\n\t\t}\n\t\t/**\n   * Restaurant image URL.\n   */\n\n\t}, {\n\t\tkey: 'imageUrlForRestaurant',\n\t\tvalue: function imageUrlForRestaurant(restaurant, size) {\n\t\t\tvar img = restaurant.photograph;\n\t\t\treturn img ? '/img/' + img + '-' + size + '.jpg' : '/img/restaurant_placeholder.svg';\n\t\t}\n\t\t/**\n   * Map marker for a restaurant.\n   */\n\n\t}, {\n\t\tkey: 'mapMarkerForRestaurant',\n\t\tvalue: function mapMarkerForRestaurant(restaurant, map) {\n\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\tposition: restaurant.latlng,\n\t\t\t\ttitle: restaurant.name,\n\t\t\t\turl: this.urlForRestaurant(restaurant),\n\t\t\t\tmap: map,\n\t\t\t\tanimation: google.maps.Animation.DROP });\n\t\t\treturn marker;\n\t\t}\n\t}, {\n\t\tkey: 'handleResponseError',\n\t\tvalue: function handleResponseError(response, type) {\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 400:\n\t\t\t\t\treturn new Error('Bed request');\n\t\t\t\tcase 404:\n\t\t\t\t\treturn new Error('Not found');\n\t\t\t\tcase 500:\n\t\t\t\t\treturn new Error('Internal server error');\n\t\t\t}\n\t\t}\n\t}]);\n\n\treturn DBHelper;\n}();\n\nexports.default = DBHelper;\n\n},{\"idb\":5}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Main = Main;\n\nvar _mainController = require('./mainController');\n\nvar _mainController2 = _interopRequireDefault(_mainController);\n\nvar _dbhelper = require('./dbhelper');\n\nvar _dbhelper2 = _interopRequireDefault(_dbhelper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar map;\n\nfunction Main() {\n\tvar _this = this;\n\n\t// let restaurants,neighborhoods, cuisines;\n\t// this.markers = [];\n\n\tthis.controller = new _mainController2.default(document.querySelector('#app-main'));\n\n\tthis.controller.fetchNeighborhoods();\n\tthis.controller.fetchCuisines();\n\n\t/**\n * Initialize Google map, called from HTML.\n */\n\twindow.initMap = function () {\n\t\tvar loc = {\n\t\t\tlat: 40.722216,\n\t\t\tlng: -73.987501\n\t\t};\n\t\tself.map = new google.maps.Map(document.getElementById('map'), {\n\t\t\tzoom: 12,\n\t\t\tcenter: loc,\n\t\t\tscrollwheel: false\n\t\t});\n\t\t_this.updateRestaurants();\n\t};\n}\n\nMain.prototype.updateRestaurants = function () {\n\n\tvar cSelect = document.getElementById('cuisines-select');\n\tvar nSelect = document.getElementById('neighborhoods-select');\n\n\tvar cIndex = cSelect.selectedIndex;\n\tvar nIndex = nSelect.selectedIndex;\n\n\tvar cuisine = cSelect[cIndex].value;\n\tvar neighborhood = nSelect[nIndex].value;\n\n\tthis.controller.fetchRestaurants(cuisine, neighborhood);\n};\n\ndocument.addEventListener('DOMContentLoaded', function (event) {\n\twindow.main = new Main();\n});\n\n},{\"./dbhelper\":1,\"./mainController\":3}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = MainController;\n\nvar _dbhelper = require('./dbhelper');\n\nvar _dbhelper2 = _interopRequireDefault(_dbhelper);\n\nvar _util = require('./util');\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction MainController(container) {\n\n\t// let restaurants,neighborhoods, cuisines;\n\n\tthis.markers = [];\n\tthis._container = container;\n\tthis._registerServiceWorker();\n\n\tthis.db = new _dbhelper2.default();\n}\n\nMainController.prototype._registerServiceWorker = function () {\n\n\tif (navigator.serviceWorker) {\n\n\t\tif (navigator.serviceWorker.controller) return;\n\n\t\tnavigator.serviceWorker.register('/sw.js', { scope: '' }).then(function (swReg) {\n\t\t\tconsole.log('\\nServiceWorker successfully registred. Scope\\n', swReg.scope);\n\t\t}).catch(function (err) {\n\t\t\tconsole.log('\\nServiceWorker swReg failed :(\\n', err.message);\n\t\t});\n\n\t\t// check connetion every 5 seconds\n\t\tvar checkConnection = setTimeout(function () {\n\t\t\tif (!navigator.onLine) handleError(new Error('No Connection'));\n\t\t}, 5000);\n\t}\n};\n\nMainController.prototype.fetchRestaurants = function (cuisine, neighborhood) {\n\tvar _this = this;\n\n\tthis.db.fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, function (error, restaurants) {\n\t\tif (error) {\n\t\t\t// Got an error!\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this.resetRestaurants(restaurants);\n\t\t\t_this.fillRestaurantsHTML();\n\t\t\treturn restaurants;\n\t\t}\n\t});\n};\n\n/**\n * Fetch all neighborhoods and set their HTML.\n */\nMainController.prototype.fetchNeighborhoods = function () {\n\tvar _this2 = this;\n\n\tthis.db.fetchNeighborhoods(function (error, neighborhoods) {\n\t\tif (error) {\n\t\t\t// Got an error\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this2.neighborhoods = neighborhoods;\n\t\t\t_this2.fillNeighborhoodsHTML();\n\t\t}\n\t});\n};\n\n/**\n * Set neighborhoods HTML.\n */\nMainController.prototype.fillNeighborhoodsHTML = function () {\n\tvar neighborhoods = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.neighborhoods;\n\n\tvar select = document.getElementById('neighborhoods-select');\n\tneighborhoods.forEach(function (neighborhood) {\n\t\tvar option = document.createElement('option');\n\t\toption.innerHTML = neighborhood;\n\t\toption.value = neighborhood;\n\t\tselect.append(option);\n\t});\n};\n\n/**\n * Fetch all cuisines and set their HTML.\n */\nMainController.prototype.fetchCuisines = function () {\n\tvar _this3 = this;\n\n\tthis.db.fetchCuisines(function (error, cuisines) {\n\t\tif (error) {\n\t\t\t// Got an error!\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this3.cuisines = cuisines;\n\t\t\t_this3.fillCuisinesHTML();\n\t\t}\n\t});\n};\n\n/**\n * Set cuisines HTML.\n */\nMainController.prototype.fillCuisinesHTML = function () {\n\tvar cuisines = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.cuisines;\n\n\tvar select = document.getElementById('cuisines-select');\n\tcuisines.forEach(function (cuisine) {\n\t\tvar option = document.createElement('option');\n\t\toption.innerHTML = cuisine;\n\t\toption.value = cuisine;\n\t\tselect.append(option);\n\t});\n};\n\n/**\n * Clear current restaurants, their HTML and remove their map markers.\n */\nMainController.prototype.resetRestaurants = function (restaurants) {\n\t// Remove all restaurants\n\tthis.restaurants = [];\n\tvar ul = document.getElementById('restaurants-list');\n\tul.innerHTML = '';\n\n\t// Remove all map markers\n\tthis.markers.forEach(function (m) {\n\t\treturn m.setMap(null);\n\t});\n\tthis.markers = [];\n\tthis.restaurants = restaurants;\n};\n\n/**\n * Create all restaurants HTML and add them to the webpage.\n */\nMainController.prototype.fillRestaurantsHTML = function () {\n\tvar _this4 = this;\n\n\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurants;\n\n\tvar ul = document.getElementById('restaurants-list');\n\trestaurants.forEach(function (restaurant) {\n\t\tul.append(_this4.createRestaurantHTML(restaurant));\n\t});\n\tthis.addMarkersToMap();\n};\n\n/**\n * Create restaurant HTML.\n */\nMainController.prototype.createRestaurantHTML = function (restaurant) {\n\n\tvar li = document.createElement('li');\n\tli.setAttribute('aria-label', restaurant.name + ' - ' + restaurant.cuisine_type + ' - ' + restaurant.address);\n\n\tvar image = document.createElement('img');\n\timage.className = 'restaurant-img';\n\timage.src = this.db.imageUrlForRestaurant(restaurant, 600);\n\timage.alt = 'Photo of ' + restaurant.name + ' restaurant';\n\timage.srcset = this.db.imageUrlForRestaurant(restaurant, 1200) + ' 1200w, ' + this.db.imageUrlForRestaurant(restaurant, 600) + ' 600w';\n\n\tli.append(image);\n\n\tvar name = document.createElement('h2');\n\tname.innerHTML = restaurant.name;\n\tli.append(name);\n\n\tvar neighborhood = document.createElement('p');\n\tneighborhood.innerHTML = restaurant.neighborhood;\n\tli.append(neighborhood);\n\n\tvar address = document.createElement('p');\n\taddress.innerHTML = restaurant.address;\n\tli.append(address);\n\n\tvar more = document.createElement('a');\n\tmore.innerHTML = 'View Details';\n\tmore.href = this.db.urlForRestaurant(restaurant);\n\tli.append(more);\n\n\t// const hr = document.createElement('hr');\n\t// hr.className = 'list-hr';\n\t// li.append(hr);\n\n\treturn li;\n};\n\n/**\n * Add markers for current restaurants to the map.\n */\nMainController.prototype.addMarkersToMap = function () {\n\tvar _this5 = this;\n\n\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurants;\n\n\trestaurants.forEach(function (restaurant) {\n\t\t// Add marker to the map\n\t\tvar marker = _this5.db.mapMarkerForRestaurant(restaurant, self.map);\n\t\tgoogle.maps.event.addListener(marker, 'click', function () {\n\t\t\twindow.location.href = marker.url;\n\t\t});\n\t\t_this5.markers.push(marker);\n\t});\n};\n\nfunction handleError(error) {\n\t_util2.default.snackbar(document.querySelector('#snackbar'), error.message);\n}\n\n},{\"./dbhelper\":1,\"./util\":4}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Utility functions\n\n\nvar Util = function () {\n\tfunction Util() {\n\t\t_classCallCheck(this, Util);\n\t}\n\n\t_createClass(Util, null, [{\n\t\tkey: 'snackbar',\n\t\tvalue: function snackbar(el, message) {\n\t\t\tvar color = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '#D9001F';\n\n\n\t\t\t// TODO\n\t\t\t// Create a element if the selected element does not existe\n\t\t\t// var newDiv = document.createElement(\"div\"); \n\n\t\t\tif (!el) {\n\t\t\t\tconsole.log(new Error('Snackbar element not valid'));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tel.innerHTML = message;\n\t\t\tel.style.visibility = 'visible';\n\t\t\tel.style.background = color;\n\t\t\tsetTimeout(function () {\n\t\t\t\tel.style.visibility = 'hidden';\n\t\t\t}, 5500);\n\t\t}\n\t}]);\n\n\treturn Util;\n}();\n\nexports.default = Util;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n},{}]},{},[2])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kYmhlbHBlci5qcyIsImpzL21haW4uanMiLCJqcy9tYWluQ29udHJvbGxlci5qcyIsImpzL3V0aWwuanMiLCJub2RlX21vZHVsZXMvaWRiL2xpYi9pZGIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztBQ0FBOzs7Ozs7OztBQUVBOzs7SUFHcUIsUTs7Ozs7QUFFcEI7Ozs7c0JBSW1CO0FBQ2xCLE9BQU0sT0FBTyxJQUFiLENBRGtCLENBQ0M7QUFDbkIsZ0NBQTJCLElBQTNCO0FBQ0E7OztBQUVELHFCQUFhO0FBQUE7O0FBQ1osT0FBSyxJQUFMLEdBQVksS0FBSyxZQUFMLEVBQVo7QUFDQTs7OztpQ0FFYztBQUNkLE9BQUksQ0FBQyxVQUFVLGFBQWYsRUFBOEIsT0FBTyxRQUFRLE9BQVIsRUFBUDs7QUFFOUIsVUFBTyxjQUFJLElBQUosQ0FBUyxTQUFULEVBQW9CLENBQXBCLEVBQXVCLFVBQUMsVUFBRCxFQUFnQjtBQUM3QyxZQUFPLFdBQVcsVUFBbEI7QUFDQSxVQUFLLENBQUw7QUFDQyxVQUFNLFVBQVUsV0FBVyxpQkFBWCxDQUE2QixTQUE3QixFQUF3QyxFQUFDLFNBQVMsSUFBVixFQUF4QyxDQUFoQjtBQUNBLFVBQU0sUUFBUSxRQUFRLFdBQVIsQ0FBb0IsT0FBcEIsRUFBNkIsSUFBN0IsQ0FBZDtBQUNBLGNBQVEsR0FBUixDQUFZLDRCQUFaO0FBSkQ7QUFNQSxJQVBNLENBQVA7QUFRQTs7OzhCQUUwQjtBQUFBLE9BQWpCLFdBQWlCLHVFQUFILEVBQUc7O0FBQ3pCO0FBQ0QsUUFBSyxJQUFMLENBQVUsSUFBVixDQUFlLGNBQU07QUFDcEIsUUFBSSxDQUFDLEVBQUwsRUFBUzs7QUFFVCxRQUFNLEtBQUssR0FBRyxXQUFILENBQWUsU0FBZixFQUEwQixXQUExQixDQUFYO0FBQ0EsUUFBTSxpQkFBaUIsR0FBRyxXQUFILENBQWUsU0FBZixDQUF2QjtB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LEtBQUgsQ0FBUyxVQUFULEdBQXNCLEtBQXRCO0FBQ0EsY0FBVyxZQUFNO0FBQUUsT0FBRyxLQUFILENBQVMsVUFBVCxHQUFzQixRQUF0QjtBQUFpQyxJQUFwRCxFQUFzRCxJQUF0RDtBQUNBOzs7Ozs7a0JBakJtQixJOzs7QUNIckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCBJREIgZnJvbSAnaWRiJztcblxuLypcbiogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXG4qL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgREJIZWxwZXIge1xuXG5cdC8qKlxuXHQgKiBEYXRhYmFzZSBVUkwuXG5cdCAqIENoYW5nZSB0aGlzIHRvIHJlc3RhdXJhbnRzLmpzb24gZmlsZSBsb2NhdGlvbiBvbiB5b3VyIHNlcnZlci5cblx0ICovXG5cdGdldCBEQVRBQkFTRV9VUkwoKSB7XG5cdFx0Y29uc3QgcG9ydCA9IDEzMzc7IC8vIENoYW5nZSB0aGlzIHRvIHlvdXIgc2VydmVyIHBvcnRcblx0XHRyZXR1cm4gYGh0dHA6Ly9sb2NhbGhvc3Q6JHtwb3J0fS9yZXN0YXVyYW50c2A7XG5cdH1cblxuXHRjb25zdHJ1Y3Rvcigpe1xuXHRcdHRoaXMuX0lEQiA9IHRoaXMub3BlbkRhdGFiYXNlKCk7XG5cdH1cblxuXHRvcGVuRGF0YWJhc2UoKSB7XG5cdFx0aWYgKCFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuXG5cdFx0cmV0dXJuIElEQi5vcGVuKCdycmV2aWV3JywgMSwgKHVwZ3JhZGVkREIpID0+IHtcblx0XHRcdHN3aXRjaCh1cGdyYWRlZERCLm9sZFZlcnNpb24pe1xuXHRcdFx0Y2FzZSAwOiBcblx0XHRcdFx0Y29uc3QgcnJldmlldyA9IHVwZ3JhZGVkREIuY3JlYXRlT2JqZWN0U3RvcmUoJ3JyZXZpZXcnLCB7a2V5UGF0aDogJ2lkJ30pO1xuXHRcdFx0XHRjb25zdCBpbmRleCA9IHJyZXZpZXcuY3JlYXRlSW5kZXgoJ2J5LWlkJywgJ2lkJyk7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCdEYXRhYmFzZSBhbmQgSW5kZXggY3JlYXRlZCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0Y2FjaGVEYXRhKHJlc3RhdXJhbnRzID0gW10pe1xuXHRcdCAvLyBhZGQgcG9zdCB0aGUgbG9jYWwgREJcblx0XHR0aGlzLl9JREIudGhlbihkYiA9PiB7XG5cdFx0XHRpZiAoIWRiKSByZXR1cm47XG5cblx0XHRcdGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ3JyZXZpZXcnLCAncmVhZHdyaXRlJyk7XG5cdFx0XHRjb25zdCByZWFkd3JpdGVTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdycmV2aWV3Jyk7XG5cdFx0XHRyZXN0YXVyYW50cy5mb3JFYWNoKChyZXN0YXVyYW50KSA9PiByZWFkd3JpdGVTdG9yZS5wdXQocmVzdGF1cmFudCkpO1xuXHRcdFx0dHguY29tcGxldGUudGhlbigoKSA9PiBjb25zb2xlLmxvZygncG9zdCBhZGRlZCB0byBpbmRleGVkREInKSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcbiAqIExvYWQgZGF0YSBmcm9tIHRoZSBjbGllbnQgZGF0YWJhc2UuXG4gKi9cblx0bG9hZENhY2hlKCkge1xuXHRcdHJldHVybiB0aGlzLl9JREIudGhlbihkYiA9PiB7XG5cdFx0XHRpZiAoIWRiKSByZXR1cm47XG5cdFx0XHRyZXR1cm4gZGIudHJhbnNhY3Rpb24oJ3JyZXZpZXcnKVxuXHRcdFx0XHQub2JqZWN0U3RvcmUoJ3JyZXZpZXcnKVxuXHRcdFx0XHQuaW5kZXgoJ2J5LWlkJylcblx0XHRcdFx0LmdldEFsbCgpO1xuXHRcdH0pLnRoZW4ocnJldmlldyA9PiBycmV2aWV3KTtcblx0fTtcblxuXHQvKiogVE9ET1xuXHQqIEltcGxlbWVudCBTb2NrZXQgdG8gbG9hZCByZWFsIHRpbWVzIGRhdGFiYXNlIGxvYWRzXG5cdCovXG5cblx0LyoqXG5cdCAqIEZldGNoIGFsbCByZXN0YXVyYW50cy5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudHMoY2FsbGJhY2spIHtcblx0XHR0aGlzLmxvYWRDYWNoZSgpLnRoZW4oZGF0YSA9PiB7XG5cdFx0XHRpZihkYXRhLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgZGF0YSk7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGZldGNoKHRoaXMuREFUQUJBU0VfVVJMKS50aGVuKHJlc3BvbnNlID0+IHtcblx0XHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcblx0XHRcdFx0XHRcdHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4ge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmNhY2hlRGF0YShkYXRhKTtcblx0XHRcdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgZGF0YSk7XG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKCdkYXRhIGxvYWRlZCBmcm9tIGxvY2FsIHN0b3JhZ2UhJyk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y2FsbGJhY2sodGhpcy5oYW5kbGVSZXNwb25zZUVycm9yKHJlc3BvbnNlLCAnYXBpIHJlcXVlc3QnKSwgbnVsbCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KS5jYXRjaChlcnJvciA9PiBjYWxsYmFjayhlcnJvciwgbnVsbCkpO1xuXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIEZldGNoIGEgcmVzdGF1cmFudCBieSBpdHMgSUQuXG5cdCAqL1xuXHRmZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCBjYWxsYmFjaykge1xuXHRcdC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRjb25zdCByZXN0YXVyYW50ID0gcmVzdGF1cmFudHMuZmluZChyID0+IHIuaWQgPT0gaWQpO1xuXG5cdFx0XHRcdGlmIChyZXN0YXVyYW50KSB7IC8vIEdvdCB0aGUgcmVzdGF1cmFudFxuXHRcdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xuXHRcdFx0XHR9IGVsc2UgeyAvLyBSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0IGluIHRoZSBkYXRhYmFzZVxuXHRcdFx0XHRcdGNhbGxiYWNrKCdSZXN0YXVyYW50IGRvZXMgbm90IGV4aXN0JywgbnVsbCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIHR5cGUgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdCAqL1xuXHRmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmUoY3Vpc2luZSwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcdHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXG5cdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWx0ZXIgcmVzdGF1cmFudHMgdG8gaGF2ZSBvbmx5IGdpdmVuIGN1aXNpbmUgdHlwZVxuXHRcdFx0XHRjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5TmVpZ2hib3Job29kKG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gbmVpZ2hib3Job29kXG5cdFx0XHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggcmVzdGF1cmFudHMgYnkgYSBjdWlzaW5lIGFuZCBhIG5laWdoYm9yaG9vZCB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzO1xuXHRcdFx0XHRpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxuXHRcdFx0XHRcdHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxuXHRcdFx0XHRcdHJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZXQgYWxsIG5laWdoYm9yaG9vZHMgZnJvbSBhbGwgcmVzdGF1cmFudHNcblx0XHRcdFx0Y29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0ubmVpZ2hib3Job29kKTtcblx0XHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBuZWlnaGJvcmhvb2RzXG5cdFx0XHRcdGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcigodiwgaSkgPT4gbmVpZ2hib3Job29kcy5pbmRleE9mKHYpID09IGkpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVOZWlnaGJvcmhvb2RzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xuXHRcdHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKTtcblx0XHRcdFx0Ly8gUmVtb3ZlIGR1cGxpY2F0ZXMgZnJvbSBjdWlzaW5lc1xuXHRcdFx0XHRjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgdW5pcXVlQ3Vpc2luZXMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxuXHQgKi9cblx0dXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KSB7XG5cdFx0cmV0dXJuIChgLi9yZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWApO1xuXHR9XG5cdC8qKlxuXHQgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cblx0ICovXG5cdGltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzaXplKSB7XG5cdFx0bGV0IGltZyA9IHJlc3RhdXJhbnQucGhvdG9ncmFwaDtcblx0XHRyZXR1cm4gaW1nID8gKGAvaW1nLyR7aW1nfS0ke3NpemV9LmpwZ2ApIDogJy9pbWcvcmVzdGF1cmFudF9wbGFjZWhvbGRlci5zdmcnO1xuXHR9XG5cdC8qKlxuXHQgKiBNYXAgbWFya2VyIGZvciBhIHJlc3RhdXJhbnQuXG5cdCAqL1xuXHRtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xuXHRcdGNvbnN0IG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuXHRcdFx0cG9zaXRpb246IHJlc3RhdXJhbnQubGF0bG5nLFxuXHRcdFx0dGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcblx0XHRcdHVybDogdGhpcy51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxuXHRcdFx0bWFwOiBtYXAsXG5cdFx0XHRhbmltYXRpb246IGdvb2dsZS5tYXBzLkFuaW1hdGlvbi5EUk9QfVxuXHRcdCk7XG5cdFx0cmV0dXJuIG1hcmtlcjtcblx0fVxuXG5cdGhhbmRsZVJlc3BvbnNlRXJyb3IocmVzcG9uc2UsIHR5cGUpe1xuXHRcdHN3aXRjaCAocmVzcG9uc2Uuc3RhdHVzKSB7XG5cdFx0XHRjYXNlIDQwMDpcblx0XHRcdFx0cmV0dXJuIG5ldyBFcnJvcignQmVkIHJlcXVlc3QnKTtcblx0XHRcdGNhc2UgNDA0OlxuXHRcdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdOb3QgZm91bmQnKTtcblx0XHRcdGNhc2UgNTAwOiBcblx0XHRcdFx0cmV0dXJuIG5ldyBFcnJvcignSW50ZXJuYWwgc2VydmVyIGVycm9yJyk7XG5cdFx0fVxuXHR9XG5cbn1cbiIsImltcG9ydCBNYWluQ29udHJvbGxlciBmcm9tICcuL21haW5Db250cm9sbGVyJztcbmltcG9ydCBEQkhlbHBlciBmcm9tICcuL2RiaGVscGVyJztcblxudmFyIG1hcDtcblxuZXhwb3J0IGZ1bmN0aW9uIE1haW4oKSB7XG5cdC8vIGxldCByZXN0YXVyYW50cyxuZWlnaGJvcmhvb2RzLCBjdWlzaW5lcztcblx0Ly8gdGhpcy5tYXJrZXJzID0gW107XG5cblx0dGhpcy5jb250cm9sbGVyID0gbmV3IE1haW5Db250cm9sbGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhcHAtbWFpbicpKTtcblxuXHR0aGlzLmNvbnRyb2xsZXIuZmV0Y2hOZWlnaGJvcmhvb2RzKCk7XG5cdHRoaXMuY29udHJvbGxlci5mZXRjaEN1aXNpbmVzKCk7XG5cblx0LyoqXG5cdCogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuXHQqL1xuXHR3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcblx0XHRsZXQgbG9jID0ge1xuXHRcdFx0bGF0OiA0MC43MjIyMTYsXG5cdFx0XHRsbmc6IC03My45ODc1MDFcblx0XHR9O1xuXHRcdHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcblx0XHRcdHpvb206IDEyLFxuXHRcdFx0Y2VudGVyOiBsb2MsXG5cdFx0XHRzY3JvbGx3aGVlbDogZmFsc2Vcblx0XHR9KTtcblx0XHR0aGlzLnVwZGF0ZVJlc3RhdXJhbnRzKCk7XG5cdH07XG5cbn1cblxuTWFpbi5wcm90b3R5cGUudXBkYXRlUmVzdGF1cmFudHMgPSBmdW5jdGlvbigpIHtcblxuXHRjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xuXHRjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XG5cblx0Y29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xuXHRjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XG5cblx0Y29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcblx0Y29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xuXG5cdHRoaXMuY29udHJvbGxlci5mZXRjaFJlc3RhdXJhbnRzKGN1aXNpbmUsIG5laWdoYm9yaG9vZCk7XG59O1xuXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcblx0d2luZG93Lm1haW4gPSBuZXcgTWFpbigpO1xufSk7XG5cblxuIiwiaW1wb3J0IERCSGVscGVyIGZyb20gJy4vZGJoZWxwZXInO1xuaW1wb3J0IFV0aWwgZnJvbSAnLi91dGlsJztcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYWluQ29udHJvbGxlcihjb250YWluZXIpIHtcblxuXHQvLyBsZXQgcmVzdGF1cmFudHMsbmVpZ2hib3Job29kcywgY3Vpc2luZXM7XG5cblx0dGhpcy5tYXJrZXJzID0gW107XG5cdHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjtcblx0dGhpcy5fcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XG5cblx0dGhpcy5kYiA9IG5ldyBEQkhlbHBlcigpO1xufVxuXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuX3JlZ2lzdGVyU2VydmljZVdvcmtlciA9IGZ1bmN0aW9uKCkge1xuXG5cdGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikge1xuXG5cdFx0aWYgKG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmNvbnRyb2xsZXIpIHJldHVybjtcblxuXHRcdG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvc3cuanMnLCB7c2NvcGU6ICcnfSkudGhlbigoc3dSZWcpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdcXG5TZXJ2aWNlV29ya2VyIHN1Y2Nlc3NmdWxseSByZWdpc3RyZWQuIFNjb3BlXFxuJywgc3dSZWcuc2NvcGUpO1xuXHRcdH0pLmNhdGNoKChlcnIpID0+IHtcblx0XHRcdGNvbnNvbGUubG9nKCdcXG5TZXJ2aWNlV29ya2VyIHN3UmVnIGZhaWxlZCA6KFxcbicsIGVyci5tZXNzYWdlKTtcblx0XHR9KTtcblxuXHQgIC8vIGNoZWNrIGNvbm5ldGlvbiBldmVyeSA1IHNlY29uZHNcblx0ICBjb25zdCBjaGVja0Nvbm5lY3Rpb24gPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0ICAgIGlmKCFuYXZpZ2F0b3Iub25MaW5lKSBoYW5kbGVFcnJvcihuZXcgRXJyb3IoJ05vIENvbm5lY3Rpb24nKSk7XG5cdCAgfSwgNTAwMCk7XG5cdH1cbn07XG5cblxuTWFpbkNvbnRyb2xsZXIucHJvdG90eXBlLmZldGNoUmVzdGF1cmFudHMgPSBmdW5jdGlvbihjdWlzaW5lLCBuZWlnaGJvcmhvb2QpIHtcblx0dGhpcy5kYi5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcblx0XHRcdGhhbmRsZUVycm9yKGVycm9yKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5yZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcblx0XHRcdHRoaXMuZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xuXHRcdFx0cmV0dXJuIHJlc3RhdXJhbnRzO1xuXHRcdH1cblx0fSk7XG59XG5cblxuLyoqXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5mZXRjaE5laWdoYm9yaG9vZHMgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5kYi5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxuXHRcdFx0aGFuZGxlRXJyb3IoZXJyb3IpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xuXHRcdFx0dGhpcy5maWxsTmVpZ2hib3Job29kc0hUTUwoKTtcblx0XHR9XG5cdH0pO1xufTtcblxuXG4vKipcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5maWxsTmVpZ2hib3Job29kc0hUTUwgPSBmdW5jdGlvbihuZWlnaGJvcmhvb2RzID0gdGhpcy5uZWlnaGJvcmhvb2RzKSB7XG5cdGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXHRuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcblx0XHRjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcblx0XHRvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xuXHRcdG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcblx0XHRzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuZmV0Y2hDdWlzaW5lcyA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLmRiLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xuXHRcdGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG5cdFx0XHRoYW5kbGVFcnJvcihlcnJvcik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3Vpc2luZXMgPSBjdWlzaW5lcztcblx0XHRcdHRoaXMuZmlsbEN1aXNpbmVzSFRNTCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxuICovXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuZmlsbEN1aXNpbmVzSFRNTCA9IGZ1bmN0aW9uKGN1aXNpbmVzID0gdGhpcy5jdWlzaW5lcykge1xuXHRjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XG5cdGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XG5cdFx0Y29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG5cdFx0b3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XG5cdFx0b3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcblx0XHRzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5yZXNldFJlc3RhdXJhbnRzID0gZnVuY3Rpb24ocmVzdGF1cmFudHMpIHtcblx0Ly8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xuXHR0aGlzLnJlc3RhdXJhbnRzID0gW107XG5cdGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcblx0dWwuaW5uZXJIVE1MID0gJyc7XG5cblx0Ly8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xuXHR0aGlzLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcblx0dGhpcy5tYXJrZXJzID0gW107XG5cdHRoaXMucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcbn07XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuTWFpbkNvbnRyb2xsZXIucHJvdG90eXBlLmZpbGxSZXN0YXVyYW50c0hUTUwgPSBmdW5jdGlvbihyZXN0YXVyYW50cyA9IHRoaXMucmVzdGF1cmFudHMpIHtcblx0Y29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xuXHRyZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuXHRcdHVsLmFwcGVuZCh0aGlzLmNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcblx0fSk7XG5cdHRoaXMuYWRkTWFya2Vyc1RvTWFwKCk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IGZ1bmN0aW9uKHJlc3RhdXJhbnQpIHtcblxuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGAke3Jlc3RhdXJhbnQubmFtZX0gLSAke3Jlc3RhdXJhbnQuY3Vpc2luZV90eXBlfSAtICR7cmVzdGF1cmFudC5hZGRyZXNzfWApO1xuXG5cdGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG5cdGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG5cdGltYWdlLnNyYyA9IHRoaXMuZGIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIDYwMCk7XG5cdGltYWdlLmFsdCA9IGBQaG90byBvZiAke3Jlc3RhdXJhbnQubmFtZX0gcmVzdGF1cmFudGA7XG5cdGltYWdlLnNyY3NldCA9IGAke3RoaXMuZGIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIDEyMDApfSAxMjAwdywgJHt0aGlzLmRiLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCA2MDApfSA2MDB3YDtcblxuXHRsaS5hcHBlbmQoaW1hZ2UpO1xuXG5cdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuXHRuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblx0bGkuYXBwZW5kKG5hbWUpO1xuXG5cdGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0bmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xuXHRsaS5hcHBlbmQobmVpZ2hib3Job29kKTtcblxuXHRjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblx0bGkuYXBwZW5kKGFkZHJlc3MpO1xuXG5cdGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdG1vcmUuaW5uZXJIVE1MID0gJ1ZpZXcgRGV0YWlscyc7XG5cdG1vcmUuaHJlZiA9IHRoaXMuZGIudXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcblx0bGkuYXBwZW5kKG1vcmUpO1xuXG5cdC8vIGNvbnN0IGhyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaHInKTtcblx0Ly8gaHIuY2xhc3NOYW1lID0gJ2xpc3QtaHInO1xuXHQvLyBsaS5hcHBlbmQoaHIpO1xuXG5cdHJldHVybiBsaTtcbn07XG5cbi8qKlxuICogQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cbiAqL1xuTWFpbkNvbnRyb2xsZXIucHJvdG90eXBlLmFkZE1hcmtlcnNUb01hcCA9IGZ1bmN0aW9uKHJlc3RhdXJhbnRzID0gdGhpcy5yZXN0YXVyYW50cykge1xuXHRyZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuXHRcdC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxuXHRcdGNvbnN0IG1hcmtlciA9IHRoaXMuZGIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XG5cdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmw7XG5cdFx0fSk7XG5cdFx0dGhpcy5tYXJrZXJzLnB1c2gobWFya2VyKTtcblx0fSk7XG59O1xuXG5mdW5jdGlvbiBoYW5kbGVFcnJvcihlcnJvcikge1xuXHRVdGlsLnNuYWNrYmFyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzbmFja2JhcicpLCBlcnJvci5tZXNzYWdlKTtcbn1cbiIsIi8vIFV0aWxpdHkgZnVuY3Rpb25zXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbCB7XG5cblx0c3RhdGljIHNuYWNrYmFyKGVsLCBtZXNzYWdlLCBjb2xvciA9ICcjRDkwMDFGJykge1xuXG5cdFx0Ly8gVE9ET1xuXHRcdC8vIENyZWF0ZSBhIGVsZW1lbnQgaWYgdGhlIHNlbGVjdGVkIGVsZW1lbnQgZG9lcyBub3QgZXhpc3RlXG5cdFx0Ly8gdmFyIG5ld0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7IFxuXG5cdFx0aWYoIWVsKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhuZXcgRXJyb3IoJ1NuYWNrYmFyIGVsZW1lbnQgbm90IHZhbGlkJykpOyBcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRlbC5pbm5lckhUTUwgPSBtZXNzYWdlO1xuXHRcdGVsLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XG5cdFx0ZWwuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yO1xuXHRcdHNldFRpbWVvdXQoKCkgPT4geyBlbC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7IH0sIDU1MDApO1xuXHR9XG59IiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcmVxdWVzdDtcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHA7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpO1xuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Q2xhc3MucHJvdG90eXBlLCBwcm9wLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgdGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0uYXBwbHkodGhpc1t0YXJnZXRQcm9wXSwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcbiAgICB0aGlzLl9pbmRleCA9IGluZGV4O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ211bHRpRW50cnknLFxuICAgICd1bmlxdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdnZXQnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuICAgIHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuICAgICdkaXJlY3Rpb24nLFxuICAgICdrZXknLFxuICAgICdwcmltYXJ5S2V5JyxcbiAgICAndmFsdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuICAgICd1cGRhdGUnLFxuICAgICdkZWxldGUnXG4gIF0pO1xuXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG4gIFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICBpZiAoIShtZXRob2ROYW1lIGluIElEQkN1cnNvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGN1cnNvciA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICBmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xuICAgIHRoaXMuX3N0b3JlID0gc3RvcmU7XG4gIH1cblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuY3JlYXRlSW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnaW5kZXhOYW1lcycsXG4gICAgJ2F1dG9JbmNyZW1lbnQnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdwdXQnLFxuICAgICdhZGQnLFxuICAgICdkZWxldGUnLFxuICAgICdjbGVhcicsXG4gICAgJ2dldCcsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdkZWxldGVJbmRleCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuICAgIHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xuICAgICdvYmplY3RTdG9yZU5hbWVzJyxcbiAgICAnbW9kZSdcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFRyYW5zYWN0aW9uLCAnX3R4JywgSURCVHJhbnNhY3Rpb24sIFtcbiAgICAnYWJvcnQnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IG9sZFZlcnNpb247XG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gIH1cblxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnZGVsZXRlT2JqZWN0U3RvcmUnLFxuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gREIoZGIpIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICB9XG5cbiAgREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLl9kYi50cmFuc2FjdGlvbi5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKERCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xuICAvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXG4gIFsnb3BlbkN1cnNvcicsICdvcGVuS2V5Q3Vyc29yJ10uZm9yRWFjaChmdW5jdGlvbihmdW5jTmFtZSkge1xuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICAgIC8vIERvbid0IGNyZWF0ZSBpdGVyYXRlS2V5Q3Vyc29yIGlmIG9wZW5LZXlDdXJzb3IgZG9lc24ndCBleGlzdC5cbiAgICAgIGlmICghKGZ1bmNOYW1lIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblxuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICB1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbihkYikge1xuICAgICAgICByZXR1cm4gbmV3IERCKGRiKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xuICAgIH1cbiAgfTtcblxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cDtcbiAgICBtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XG4gIH1cbiAgZWxzZSB7XG4gICAgc2VsZi5pZGIgPSBleHA7XG4gIH1cbn0oKSk7XG4iXX0=\n"]}