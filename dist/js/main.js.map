{"version":3,"sources":["main.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","obj","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_idb","_idb2","__esModule","default","DBHelper","instance","TypeError","_classCallCheck","this","_IDB","openDatabase","get","navigator","serviceWorker","open","upgradedDB","oldVersion","createObjectStore","keyPath","createIndex","console","log","Promise","resolve","restaurants","arguments","undefined","then","db","tx","transaction","readwriteStore","objectStore","forEach","restaurant","put","complete","index","getAll","rreview","callback","_this","loadCache","data","fetch","DATABASE_URL","response","status","json","cacheData","handleResponseError","catch","error","id","fetchRestaurants","find","cuisine","results","filter","cuisine_type","neighborhood","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","size","img","photograph","google","maps","Marker","position","latlng","title","name","url","urlForRestaurant","animation","Animation","DROP","type","idb","2","Main","_mainController","_mainController2","controller","document","querySelector","fetchNeighborhoods","fetchCuisines","updateRestaurants","window","addEventListener","script","createElement","setAttribute","src","getElementById","appendChild","initMap","self","Map","zoom","center","lat","lng","scrollwheel","addMarkersToMap","cSelect","nSelect","cIndex","selectedIndex","nIndex","main","./mainController","3","MainController","_dbhelper2","_interopRequireDefault","_util2","container","markers","_container","_registerServiceWorker","checkConnection","onLine","handleError","setTimeout","snackbar","message","register","scope","swReg","err","fetchRestaurantByCuisineAndNeighborhood","resetRestaurants","fillRestaurantsHTML","_this2","fillNeighborhoodsHTML","select","option","innerHTML","append","_this3","fillCuisinesHTML","m","setMap","_this4","ul","createRestaurantHTML","imgLazyLoader","li","address","image","className","imageUrlForRestaurant","alt","more","href","_this5","marker","mapMarkerForRestaurant","event","addListener","location","push","./dbhelper","./util","4","Util","el","color","style","background","removeAttribute","imgs","querySelectorAll","IntersectionObserver","observer","entries","obsr","entry","intersectionRatio","unobserve","preloadImage","rootMargin","threshold","observe","nodeName","getAttribute","5","promisifyRequest","request","reject","onsuccess","result","onerror","promisifyRequestCall","method","args","apply","proxyProperties","ProxyClass","targetProp","properties","prop","set","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Cursor","Index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","replace","arr","Array","slice","nativeObject","query","count","items","iterateCursor","continue","exp","version","upgradeCallback","indexedDB","onupgradeneeded","delete"],"mappings":"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","file":"main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _idb = require('idb');\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* Common database helper functions.\n*/\nvar DBHelper = function () {\n\t_createClass(DBHelper, [{\n\t\tkey: 'DATABASE_URL',\n\n\n\t\t/**\n   * Database URL.\n   * Change this to restaurants.json file location on your server.\n   */\n\t\tget: function get() {\n\t\t\tvar port = 1337; // Change this to your server port\n\t\t\treturn 'http://localhost:' + port + '/restaurants';\n\t\t}\n\t}]);\n\n\tfunction DBHelper() {\n\t\t_classCallCheck(this, DBHelper);\n\n\t\tthis._IDB = this.openDatabase();\n\t}\n\n\t_createClass(DBHelper, [{\n\t\tkey: 'openDatabase',\n\t\tvalue: function openDatabase() {\n\t\t\tif (!navigator.serviceWorker) return Promise.resolve();\n\n\t\t\treturn _idb2.default.open('rreview', 1, function (upgradedDB) {\n\t\t\t\tswitch (upgradedDB.oldVersion) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tvar rreview = upgradedDB.createObjectStore('rreview', { keyPath: 'id' });\n\t\t\t\t\t\tvar index = rreview.createIndex('by-id', 'id');\n\t\t\t\t\t\tconsole.log('Database and Index created');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'cacheData',\n\t\tvalue: function cacheData() {\n\t\t\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n\t\t\t// add post the local DB\n\t\t\tthis._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\n\t\t\t\tvar tx = db.transaction('rreview', 'readwrite');\n\t\t\t\tvar readwriteStore = tx.objectStore('rreview');\n\t\t\t\trestaurants.forEach(function (restaurant) {\n\t\t\t\t\treturn readwriteStore.put(restaurant);\n\t\t\t\t});\n\t\t\t\ttx.complete.then(function () {\n\t\t\t\t\treturn console.log('post added to indexedDB');\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n  * Load data from the client database.\n  */\n\n\t}, {\n\t\tkey: 'loadCache',\n\t\tvalue: function loadCache() {\n\t\t\treturn this._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\t\t\t\treturn db.transaction('rreview').objectStore('rreview').index('by-id').getAll();\n\t\t\t}).then(function (rreview) {\n\t\t\t\treturn rreview;\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'fetchRestaurants',\n\n\n\t\t/** TODO\n  * Implement Socket to load real times database loads\n  */\n\n\t\t/**\n   * Fetch all restaurants.\n   */\n\t\tvalue: function fetchRestaurants(callback) {\n\t\t\tvar _this = this;\n\n\t\t\tthis.loadCache().then(function (data) {\n\t\t\t\tif (data.length > 0) {\n\t\t\t\t\tcallback(null, data);\n\t\t\t\t} else {\n\n\t\t\t\t\tfetch(_this.DATABASE_URL).then(function (response) {\n\t\t\t\t\t\tif (response.status === 200) {\n\t\t\t\t\t\t\tresponse.json().then(function (data) {\n\t\t\t\t\t\t\t\t_this.cacheData(data);\n\t\t\t\t\t\t\t\tcallback(null, data);\n\t\t\t\t\t\t\t\tconsole.log('data loaded from local storage!');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback(_this.handleResponseError(response, 'api request'), null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(function (error) {\n\t\t\t\t\t\treturn callback(error, null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch a restaurant by its ID.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantById',\n\t\tvalue: function fetchRestaurantById(id, callback) {\n\t\t\t// fetch all restaurants with proper error handling.\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\n\t\t\t\t\tvar restaurant = restaurants.find(function (r) {\n\t\t\t\t\t\treturn r.id == id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (restaurant) {\n\t\t\t\t\t\t// Got the restaurant\n\t\t\t\t\t\tcallback(null, restaurant);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Restaurant does not exist in the database\n\t\t\t\t\t\tcallback('Restaurant does not exist', null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine type with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisine',\n\t\tvalue: function fetchRestaurantByCuisine(cuisine, callback) {\n\t\t\t// Fetch all restaurants\twith proper error handling\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given cuisine type\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByNeighborhood',\n\t\tvalue: function fetchRestaurantByNeighborhood(neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given neighborhood\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisineAndNeighborhood',\n\t\tvalue: function fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\tvar results = restaurants;\n\t\t\t\t\tif (cuisine != 'all') {\n\t\t\t\t\t\t// filter by cuisine\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (neighborhood != 'all') {\n\t\t\t\t\t\t// filter by neighborhood\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all neighborhoods with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchNeighborhoods',\n\t\tvalue: function fetchNeighborhoods(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all neighborhoods from all restaurants\n\t\t\t\t\tvar neighborhoods = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from neighborhoods\n\t\t\t\t\tvar uniqueNeighborhoods = neighborhoods.filter(function (v, i) {\n\t\t\t\t\t\treturn neighborhoods.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueNeighborhoods);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all cuisines with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchCuisines',\n\t\tvalue: function fetchCuisines(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all cuisines from all restaurants\n\t\t\t\t\tvar cuisines = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].cuisine_type;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from cuisines\n\t\t\t\t\tvar uniqueCuisines = cuisines.filter(function (v, i) {\n\t\t\t\t\t\treturn cuisines.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueCuisines);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Restaurant page URL.\n   */\n\n\t}, {\n\t\tkey: 'urlForRestaurant',\n\t\tvalue: function urlForRestaurant(restaurant) {\n\t\t\treturn './restaurant.html?id=' + restaurant.id;\n\t\t}\n\t\t/**\n   * Restaurant image URL.\n   */\n\n\t}, {\n\t\tkey: 'imageUrlForRestaurant',\n\t\tvalue: function imageUrlForRestaurant(restaurant, size) {\n\t\t\tvar img = restaurant.photograph;\n\t\t\treturn img ? '/img/' + img + '-' + size + '.jpg' : '/img/restaurant_placeholder.svg';\n\t\t}\n\t\t/**\n   * Map marker for a restaurant.\n   */\n\n\t}, {\n\t\tkey: 'mapMarkerForRestaurant',\n\t\tvalue: function mapMarkerForRestaurant(restaurant, map) {\n\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\tposition: restaurant.latlng,\n\t\t\t\ttitle: restaurant.name,\n\t\t\t\turl: this.urlForRestaurant(restaurant),\n\t\t\t\tmap: map,\n\t\t\t\tanimation: google.maps.Animation.DROP });\n\t\t\treturn marker;\n\t\t}\n\t}, {\n\t\tkey: 'handleResponseError',\n\t\tvalue: function handleResponseError(response, type) {\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 400:\n\t\t\t\t\treturn new Error('Bed request');\n\t\t\t\tcase 404:\n\t\t\t\t\treturn new Error('Not found');\n\t\t\t\tcase 500:\n\t\t\t\t\treturn new Error('Internal server error');\n\t\t\t}\n\t\t}\n\t}]);\n\n\treturn DBHelper;\n}();\n\nexports.default = DBHelper;\n\n},{\"idb\":5}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Main = Main;\n\nvar _mainController = require('./mainController');\n\nvar _mainController2 = _interopRequireDefault(_mainController);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar map;\n\nfunction Main() {\n\tvar _this = this;\n\n\tthis.controller = new _mainController2.default(document.querySelector('#app-main'));\n\tthis.controller.fetchNeighborhoods();\n\tthis.controller.fetchCuisines();\n\n\tthis.updateRestaurants();\n\n\t/**\n * Initialize Google map, called from HTML.\n */\n\twindow.addEventListener('load', function (e) {\n\t\tconsole.log('All resources finished loading!');\n\n\t\tvar script = document.createElement('script');\n\t\tscript.setAttribute('async', true);\n\t\tscript.setAttribute('defer', true);\n\t\tscript.src = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyCAGI5xQ4PXUpi6HNhM7fwIVzSzTVVJz5E&libraries=places&callback=initMap';\n\t\tdocument.getElementById('app-main').appendChild(script);\n\n\t\twindow.initMap = function () {\n\t\t\tvar loc = {\n\t\t\t\tlat: 40.722216,\n\t\t\t\tlng: -73.987501\n\t\t\t};\n\t\t\tself.map = new google.maps.Map(document.getElementById('map'), {\n\t\t\t\tzoom: 12,\n\t\t\t\tcenter: loc,\n\t\t\t\tscrollwheel: false\n\t\t\t});\n\t\t\t_this.controller.addMarkersToMap();\n\t\t};\n\t});\n}\n\nMain.prototype.updateRestaurants = function () {\n\n\tvar cSelect = document.getElementById('cuisines-select');\n\tvar nSelect = document.getElementById('neighborhoods-select');\n\n\tvar cIndex = cSelect.selectedIndex;\n\tvar nIndex = nSelect.selectedIndex;\n\n\tvar cuisine = cSelect[cIndex].value;\n\tvar neighborhood = nSelect[nIndex].value;\n\n\tthis.controller.fetchRestaurants(cuisine, neighborhood);\n};\n\nwindow.main = new Main();\n\n},{\"./mainController\":3}],3:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = MainController;\n\nvar _dbhelper = require('./dbhelper');\n\nvar _dbhelper2 = _interopRequireDefault(_dbhelper);\n\nvar _util = require('./util');\n\nvar _util2 = _interopRequireDefault(_util);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction MainController(container) {\n\tthis.markers = [];\n\tthis._container = container;\n\tthis._registerServiceWorker();\n\n\tthis.db = new _dbhelper2.default();\n\n\tif (navigator) checkConnection();\n}\n\nMainController.prototype._registerServiceWorker = function () {\n\tif (navigator.serviceWorker) {\n\t\tif (navigator.serviceWorker.controller) return;\n\n\t\tnavigator.serviceWorker.register('/sw.js', { scope: '/' }).then(function (swReg) {\n\t\t\tconsole.log('\\nServiceWorker successfully registred. Scope\\n', swReg.scope);\n\t\t}).catch(function (err) {\n\t\t\tconsole.log('\\nServiceWorker swReg failed :(\\n', err.message);\n\t\t});\n\t}\n};\n\nMainController.prototype.fetchRestaurants = function (cuisine, neighborhood) {\n\tvar _this = this;\n\n\tthis.db.fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, function (error, restaurants) {\n\t\tif (error) {\n\t\t\t// Got an error!\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this.resetRestaurants(restaurants);\n\t\t\t_this.fillRestaurantsHTML();\n\t\t\treturn restaurants;\n\t\t}\n\t});\n};\n\n/**\n * Fetch all neighborhoods and set their HTML.\n */\nMainController.prototype.fetchNeighborhoods = function () {\n\tvar _this2 = this;\n\n\tthis.db.fetchNeighborhoods(function (error, neighborhoods) {\n\t\tif (error) {\n\t\t\t// Got an error\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this2.neighborhoods = neighborhoods;\n\t\t\t_this2.fillNeighborhoodsHTML();\n\t\t}\n\t});\n};\n\n/**\n * Set neighborhoods HTML.\n */\nMainController.prototype.fillNeighborhoodsHTML = function () {\n\tvar neighborhoods = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.neighborhoods;\n\n\tvar select = document.getElementById('neighborhoods-select');\n\tneighborhoods.forEach(function (neighborhood) {\n\t\tvar option = document.createElement('option');\n\t\toption.innerHTML = neighborhood;\n\t\toption.value = neighborhood;\n\t\tselect.append(option);\n\t});\n};\n\n/**\n * Fetch all cuisines and set their HTML.\n */\nMainController.prototype.fetchCuisines = function () {\n\tvar _this3 = this;\n\n\tthis.db.fetchCuisines(function (error, cuisines) {\n\t\tif (error) {\n\t\t\t// Got an error!\n\t\t\thandleError(error);\n\t\t} else {\n\t\t\t_this3.cuisines = cuisines;\n\t\t\t_this3.fillCuisinesHTML();\n\t\t}\n\t});\n};\n\n/**\n * Set cuisines HTML.\n */\nMainController.prototype.fillCuisinesHTML = function () {\n\tvar cuisines = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.cuisines;\n\n\tvar select = document.getElementById('cuisines-select');\n\tcuisines.forEach(function (cuisine) {\n\t\tvar option = document.createElement('option');\n\t\toption.innerHTML = cuisine;\n\t\toption.value = cuisine;\n\t\tselect.append(option);\n\t});\n};\n\n/**\n * Clear current restaurants, their HTML and remove their map markers.\n */\nMainController.prototype.resetRestaurants = function (restaurants) {\n\t// Remove all restaurants\n\tthis.restaurants = [];\n\tvar ul = document.getElementById('restaurants-list');\n\tul.innerHTML = '';\n\n\t// Remove all map markers\n\tthis.markers.forEach(function (m) {\n\t\treturn m.setMap(null);\n\t});\n\tthis.markers = [];\n\tthis.restaurants = restaurants;\n};\n\n/**\n * Create all restaurants HTML and add them to the webpage.\n */\nMainController.prototype.fillRestaurantsHTML = function () {\n\tvar _this4 = this;\n\n\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurants;\n\n\tvar ul = document.getElementById('restaurants-list');\n\trestaurants.forEach(function (restaurant) {\n\t\tul.append(_this4.createRestaurantHTML(restaurant));\n\t});\n\n\t_util2.default.imgLazyLoader('.img-lazy-load');\n\tif (self.initMap) this.addMarkersToMap();\n};\n\n/**\n * Create restaurant HTML.\n */\nMainController.prototype.createRestaurantHTML = function (restaurant) {\n\n\tvar li = document.createElement('li');\n\tli.setAttribute('aria-label', restaurant.name + ' - ' + restaurant.cuisine_type + ' - ' + restaurant.address);\n\n\tvar image = document.createElement('img');\n\timage.className = 'img-lazy-load restaurant-img';\n\timage.setAttribute('data-src', this.db.imageUrlForRestaurant(restaurant, 600));\n\timage.alt = restaurant.name + ' - ' + restaurant.cuisine_type + ' Cuisine';\n\n\tli.append(image);\n\n\tvar name = document.createElement('h2');\n\tname.innerHTML = restaurant.name;\n\tli.append(name);\n\n\tvar cuisine = document.createElement('p');\n\tcuisine.className = 'cuisine-type';\n\tcuisine.innerHTML = restaurant.cuisine_type;\n\tli.append(cuisine);\n\n\tvar neighborhood = document.createElement('p');\n\tneighborhood.innerHTML = restaurant.neighborhood;\n\tli.append(neighborhood);\n\n\tvar address = document.createElement('p');\n\taddress.innerHTML = restaurant.address;\n\tli.append(address);\n\n\tvar more = document.createElement('a');\n\tmore.innerHTML = 'View Details';\n\tmore.href = this.db.urlForRestaurant(restaurant);\n\tli.append(more);\n\n\t// const share = document.createElement('a');\n\t// share.innerHTML = 'Share';\n\t// share.href = this.db.urlForRestaurant(restaurant);\n\t// li.append(share);\n\n\treturn li;\n};\n\n/**\n * Add markers for current restaurants to the map.\n */\nMainController.prototype.addMarkersToMap = function () {\n\tvar _this5 = this;\n\n\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurants;\n\n\trestaurants.forEach(function (restaurant) {\n\t\t// Add marker to the map\n\t\tvar marker = _this5.db.mapMarkerForRestaurant(restaurant, self.map);\n\t\tgoogle.maps.event.addListener(marker, 'click', function () {\n\t\t\twindow.location.href = marker.url;\n\t\t});\n\t\t_this5.markers.push(marker);\n\t});\n};\n\nfunction checkConnection() {\n\tif (!navigator.onLine) handleError(new Error('No Connection'));\n\t// check connetion every 5 seconds\n\tvar checkTimeout = setTimeout(function () {\n\t\tcheckConnection();\n\t}, 10000);\n}\n\nfunction handleError(error) {\n\t_util2.default.snackbar(document.querySelector('#snackbar'), error.message);\n}\n\n},{\"./dbhelper\":1,\"./util\":4}],4:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Utility functions\n\n\nvar Util = function () {\n\tfunction Util() {\n\t\t_classCallCheck(this, Util);\n\t}\n\n\t_createClass(Util, null, [{\n\t\tkey: 'snackbar',\n\n\n\t\t/**\n  *\n  */\n\t\tvalue: function snackbar(el, message) {\n\t\t\tvar color = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '#D9001F';\n\n\n\t\t\t// TODO\n\t\t\t// Create a element if the selected element does not existe\n\t\t\t// var newDiv = document.createElement(\"div\"); \n\n\t\t\tif (!el) {\n\t\t\t\tconsole.log(new Error('Snackbar element not valid'));\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tel.innerHTML = message;\n\t\t\tel.setAttribute('class', 'show');\n\t\t\tel.style.background = color;\n\t\t\tsetTimeout(function () {\n\t\t\t\tel.removeAttribute('class');\n\t\t\t}, 5500);\n\t\t}\n\n\t\t/**\n  *\n  */\n\n\t}, {\n\t\tkey: 'imgLazyLoader',\n\t\tvalue: function imgLazyLoader(target) {\n\t\t\tvar imgs = document.querySelectorAll(target);\n\n\t\t\tif (!window.IntersectionObserver) {\n\t\t\t\tconsole.log('No lazy loading for you :(');\n\t\t\t\timgs.forEach(function (img) {\n\t\t\t\t\treturn Util.preloadImage(img);\n\t\t\t\t});\n\t\t\t} else {\n\n\t\t\t\tvar onIntersection = function onIntersection(entries, obsr) {\n\t\t\t\t\tentries.forEach(function (entry) {\n\t\t\t\t\t\tif (entry.intersectionRatio > 0) {\n\t\t\t\t\t\t\tobsr.unobserve(entry.target);\n\t\t\t\t\t\t\tUtil.preloadImage(entry.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\tvar obsrOptions = {\n\t\t\t\t\trootMargin: '30px 0px',\n\t\t\t\t\tthreshold: [0.1]\n\t\t\t\t};\n\n\t\t\t\tvar observer = new IntersectionObserver(onIntersection, obsrOptions);\n\t\t\t\timgs.forEach(function (target) {\n\t\t\t\t\treturn observer.observe(target);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t/**\n  *\n  */\n\n\t}, {\n\t\tkey: 'preloadImage',\n\t\tvalue: function preloadImage(target) {\n\t\t\tif (!target.nodeName === 'IMG') return false;\n\t\t\ttarget.setAttribute('src', target.getAttribute('data-src'));\n\t\t\tconsole.log('Image loaded: ', target.getAttribute('data-src'));\n\t\t\treturn target;\n\t\t}\n\t}]);\n\n\treturn Util;\n}();\n\nexports.default = Util;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n},{}]},{},[2])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kYmhlbHBlci5qcyIsImpzL21haW4uanMiLCJqcy9tYWluQ29udHJvbGxlci5qcyIsImpzL3V0aWwuanMiLCJub2RlX21vZHVsZXMvaWRiL2xpYi9pZGIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7OztBQ0FBOzs7Ozs7OztBQUVBOzs7SUFHcUIsUTs7Ozs7QUFFcEI7Ozs7c0JBSW1CO0FBQ2xCLE9BQU0sT0FBTyxJQUFiLENBRGtCLENBQ0M7QUFDbkIsZ0NBQTJCLElBQTNCO0FBQ0E7OztBQUVELHFCQUFhO0FBQUE7O0FBQ1osT0FBSyxJQUFMLEdBQVksS0FBSyxZQUFMLEVBQVo7QUFDQTs7OztpQ0FFYztBQUNkLE9BQUksQ0FBQyxVQUFVLGFBQWYsRUFBOEIsT0FBTyxRQUFRLE9BQVIsRUFBUDs7QUFFOUIsVUFBTyxjQUFJLElBQUosQ0FBUyxTQUFULEVBQW9CLENBQXBCLEVBQXVCLFVBQUMsVUFBRCxFQUFnQjtBQUM3QyxZQUFPLFdBQVcsVUFBbEI7QUFDQSxVQUFLLENBQUw7QUFDQyxVQUFNLFVBQVUsV0FBVyxpQkFBWCxDQUE2QixTQUE3QixFQUF3QyxFQUFDLFNBQVMsSUFBVixFQUF4QyxDQUFoQjtBQUNBLFVBQU0sUUFBUSxRQUFRLFdBQVIsQ0FBb0IsT0FBcEIsRUFBNkIsSUFBN0IsQ0FBZDtBQUNBLGNBQVEsR0FBUixDQUFZLDRCQUFaO0FBSkQ7QUFNQSxJQVBNLENBQVA7QUFRQTs7OzhCQUUwQjtBQUFBLE9BQWpCLFdBQWlCLHVFQUFILEVBQUc7O0FBQ3pCO0FBQ0QsUUFBSyxJQUFMLENBQVUsSUFBVixDQUFlLGNBQU07QUFDcEIsUUFBSSxDQUFDLEVBQUwsRUFBUzs7QUFFVCxRQUFNLEtBQUssR0FBRyxXQUFILENBQWUsU0FBZixFQUEwQixXQUExQixDQUFYO0FBQ0EsUUFBTSxpQkFBaUIsR0FBRyxXQUFILENBQWUsU0FBZixDQUF2QjtB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IElEQiBmcm9tICdpZGInO1xuXG4vKlxuKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cbiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEQkhlbHBlciB7XG5cblx0LyoqXG5cdCAqIERhdGFiYXNlIFVSTC5cblx0ICogQ2hhbmdlIHRoaXMgdG8gcmVzdGF1cmFudHMuanNvbiBmaWxlIGxvY2F0aW9uIG9uIHlvdXIgc2VydmVyLlxuXHQgKi9cblx0Z2V0IERBVEFCQVNFX1VSTCgpIHtcblx0XHRjb25zdCBwb3J0ID0gMTMzNzsgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxuXHRcdHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9L3Jlc3RhdXJhbnRzYDtcblx0fVxuXG5cdGNvbnN0cnVjdG9yKCl7XG5cdFx0dGhpcy5fSURCID0gdGhpcy5vcGVuRGF0YWJhc2UoKTtcblx0fVxuXG5cdG9wZW5EYXRhYmFzZSgpIHtcblx0XHRpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cblx0XHRyZXR1cm4gSURCLm9wZW4oJ3JyZXZpZXcnLCAxLCAodXBncmFkZWREQikgPT4ge1xuXHRcdFx0c3dpdGNoKHVwZ3JhZGVkREIub2xkVmVyc2lvbil7XG5cdFx0XHRjYXNlIDA6IFxuXHRcdFx0XHRjb25zdCBycmV2aWV3ID0gdXBncmFkZWREQi5jcmVhdGVPYmplY3RTdG9yZSgncnJldmlldycsIHtrZXlQYXRoOiAnaWQnfSk7XG5cdFx0XHRcdGNvbnN0IGluZGV4ID0gcnJldmlldy5jcmVhdGVJbmRleCgnYnktaWQnLCAnaWQnKTtcblx0XHRcdFx0Y29uc29sZS5sb2coJ0RhdGFiYXNlIGFuZCBJbmRleCBjcmVhdGVkJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRjYWNoZURhdGEocmVzdGF1cmFudHMgPSBbXSl7XG5cdFx0IC8vIGFkZCBwb3N0IHRoZSBsb2NhbCBEQlxuXHRcdHRoaXMuX0lEQi50aGVuKGRiID0+IHtcblx0XHRcdGlmICghZGIpIHJldHVybjtcblxuXHRcdFx0Y29uc3QgdHggPSBkYi50cmFuc2FjdGlvbigncnJldmlldycsICdyZWFkd3JpdGUnKTtcblx0XHRcdGNvbnN0IHJlYWR3cml0ZVN0b3JlID0gdHgub2JqZWN0U3RvcmUoJ3JyZXZpZXcnKTtcblx0XHRcdHJlc3RhdXJhbnRzLmZvckVhY2goKHJlc3RhdXJhbnQpID0+IHJlYWR3cml0ZVN0b3JlLnB1dChyZXN0YXVyYW50KSk7XG5cdFx0XHR0eC5jb21wbGV0ZS50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdwb3N0IGFkZGVkIHRvIGluZGV4ZWREQicpKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICogTG9hZCBkYXRhIGZyb20gdGhlIGNsaWVudCBkYXRhYmFzZS5cbiAqL1xuXHRsb2FkQ2FjaGUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX0lEQi50aGVuKGRiID0+IHtcblx0XHRcdGlmICghZGIpIHJldHVybjtcblx0XHRcdHJldHVybiBkYi50cmFuc2FjdGlvbigncnJldmlldycpXG5cdFx0XHRcdC5vYmplY3RTdG9yZSgncnJldmlldycpXG5cdFx0XHRcdC5pbmRleCgnYnktaWQnKVxuXHRcdFx0XHQuZ2V0QWxsKCk7XG5cdFx0fSkudGhlbihycmV2aWV3ID0+IHJyZXZpZXcpO1xuXHR9O1xuXG5cdC8qKiBUT0RPXG5cdCogSW1wbGVtZW50IFNvY2tldCB0byBsb2FkIHJlYWwgdGltZXMgZGF0YWJhc2UgbG9hZHNcblx0Ki9cblxuXHQvKipcblx0ICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xuXHRcdHRoaXMubG9hZENhY2hlKCkudGhlbihkYXRhID0+IHtcblx0XHRcdGlmKGRhdGEubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCBkYXRhKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0ZmV0Y2godGhpcy5EQVRBQkFTRV9VUkwpLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuXHRcdFx0XHRcdFx0cmVzcG9uc2UuanNvbigpLnRoZW4oZGF0YSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuY2FjaGVEYXRhKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayhudWxsLCBkYXRhKTtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ2RhdGEgbG9hZGVkIGZyb20gbG9jYWwgc3RvcmFnZSEnKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjYWxsYmFjayh0aGlzLmhhbmRsZVJlc3BvbnNlRXJyb3IocmVzcG9uc2UsICdhcGkgcmVxdWVzdCcpLCBudWxsKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKGVycm9yLCBudWxsKSk7XG5cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHRcdHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50cy5maW5kKHIgPT4gci5pZCA9PSBpZCk7XG5cblx0XHRcdFx0aWYgKHJlc3RhdXJhbnQpIHsgLy8gR290IHRoZSByZXN0YXVyYW50XG5cdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XG5cdFx0XHRcdH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1x0d2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXG5cdFx0XHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xuXHRcdHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2Rcblx0XHRcdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxldCByZXN1bHRzID0gcmVzdGF1cmFudHM7XG5cdFx0XHRcdGlmIChjdWlzaW5lICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBjdWlzaW5lXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG5laWdoYm9yaG9vZCAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdCAqL1xuXHRmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2QpO1xuXHRcdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcblx0XHRcdFx0Y29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdCAqL1xuXHRmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXG5cdFx0XHRcdGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpO1xuXHRcdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXG5cdFx0XHRcdGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXG5cdCAqL1xuXHR1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcblx0XHRyZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XG5cdH1cblx0LyoqXG5cdCAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxuXHQgKi9cblx0aW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNpemUpIHtcblx0XHRsZXQgaW1nID0gcmVzdGF1cmFudC5waG90b2dyYXBoO1xuXHRcdHJldHVybiBpbWcgPyAoYC9pbWcvJHtpbWd9LSR7c2l6ZX0uanBnYCkgOiAnL2ltZy9yZXN0YXVyYW50X3BsYWNlaG9sZGVyLnN2Zyc7XG5cdH1cblx0LyoqXG5cdCAqIE1hcCBtYXJrZXIgZm9yIGEgcmVzdGF1cmFudC5cblx0ICovXG5cdG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XG5cdFx0Y29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG5cdFx0XHRwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXG5cdFx0XHR0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxuXHRcdFx0dXJsOiB0aGlzLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXG5cdFx0XHRtYXA6IG1hcCxcblx0XHRcdGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1B9XG5cdFx0KTtcblx0XHRyZXR1cm4gbWFya2VyO1xuXHR9XG5cblx0aGFuZGxlUmVzcG9uc2VFcnJvcihyZXNwb25zZSwgdHlwZSl7XG5cdFx0c3dpdGNoIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdGNhc2UgNDAwOlxuXHRcdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdCZWQgcmVxdWVzdCcpO1xuXHRcdFx0Y2FzZSA0MDQ6XG5cdFx0XHRcdHJldHVybiBuZXcgRXJyb3IoJ05vdCBmb3VuZCcpO1xuXHRcdFx0Y2FzZSA1MDA6IFxuXHRcdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InKTtcblx0XHR9XG5cdH1cblxufVxuIiwiaW1wb3J0IE1haW5Db250cm9sbGVyIGZyb20gJy4vbWFpbkNvbnRyb2xsZXInO1xuXG52YXIgbWFwO1xuXG5leHBvcnQgZnVuY3Rpb24gTWFpbigpIHtcblx0dGhpcy5jb250cm9sbGVyID0gbmV3IE1haW5Db250cm9sbGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhcHAtbWFpbicpKTtcblx0dGhpcy5jb250cm9sbGVyLmZldGNoTmVpZ2hib3Job29kcygpO1xuXHR0aGlzLmNvbnRyb2xsZXIuZmV0Y2hDdWlzaW5lcygpO1xuXG5cdHRoaXMudXBkYXRlUmVzdGF1cmFudHMoKTtcblxuXHQvKipcblx0KiBJbml0aWFsaXplIEdvb2dsZSBtYXAsIGNhbGxlZCBmcm9tIEhUTUwuXG5cdCovXG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKGUpID0+IHtcblx0XHRjb25zb2xlLmxvZygnQWxsIHJlc291cmNlcyBmaW5pc2hlZCBsb2FkaW5nIScpO1xuXG5cdFx0Y29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cdFx0c2NyaXB0LnNldEF0dHJpYnV0ZSgnYXN5bmMnLCB0cnVlKTtcblx0XHRzY3JpcHQuc2V0QXR0cmlidXRlKCdkZWZlcicsIHRydWUpO1xuXHRcdHNjcmlwdC5zcmMgPSAnaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2pzP2tleT1BSXphU3lDQUdJNXhRNFBYVXBpNkhOaE03ZndJVnpTelRWVkp6NUUmbGlicmFyaWVzPXBsYWNlcyZjYWxsYmFjaz1pbml0TWFwJztcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXBwLW1haW4nKS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuXG5cdFx0d2luZG93LmluaXRNYXAgPSAoKSA9PiB7XG5cdFx0XHRsZXQgbG9jID0ge1xuXHRcdFx0XHRsYXQ6IDQwLjcyMjIxNixcblx0XHRcdFx0bG5nOiAtNzMuOTg3NTAxXG5cdFx0XHR9O1xuXHRcdFx0c2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKSwge1xuXHRcdFx0XHR6b29tOiAxMixcblx0XHRcdFx0Y2VudGVyOiBsb2MsXG5cdFx0XHRcdHNjcm9sbHdoZWVsOiBmYWxzZVxuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLmNvbnRyb2xsZXIuYWRkTWFya2Vyc1RvTWFwKCk7XG5cdFx0fTtcblxuXHR9KTtcblx0XG59XG5cbk1haW4ucHJvdG90eXBlLnVwZGF0ZVJlc3RhdXJhbnRzID0gZnVuY3Rpb24oKSB7XG5cblx0Y29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcblx0Y29uc3QgblNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXG5cdGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcblx0Y29uc3QgbkluZGV4ID0gblNlbGVjdC5zZWxlY3RlZEluZGV4O1xuXG5cdGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XG5cdGNvbnN0IG5laWdoYm9yaG9vZCA9IG5TZWxlY3RbbkluZGV4XS52YWx1ZTtcblxuXHR0aGlzLmNvbnRyb2xsZXIuZmV0Y2hSZXN0YXVyYW50cyhjdWlzaW5lLCBuZWlnaGJvcmhvb2QpO1xufTtcblxud2luZG93Lm1haW4gPSBuZXcgTWFpbigpO1xuXG4iLCJpbXBvcnQgREJIZWxwZXIgZnJvbSAnLi9kYmhlbHBlcic7XG5pbXBvcnQgVXRpbCBmcm9tICcuL3V0aWwnO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE1haW5Db250cm9sbGVyKGNvbnRhaW5lcikge1xuXHR0aGlzLm1hcmtlcnMgPSBbXTtcblx0dGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuXHR0aGlzLl9yZWdpc3RlclNlcnZpY2VXb3JrZXIoKTtcblxuXHR0aGlzLmRiID0gbmV3IERCSGVscGVyKCk7XG5cblx0aWYgKG5hdmlnYXRvcikgY2hlY2tDb25uZWN0aW9uKCk7XG59XG5cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5fcmVnaXN0ZXJTZXJ2aWNlV29ya2VyID0gZnVuY3Rpb24oKSB7XG5cdGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikge1xuXHRcdGlmIChuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyKSByZXR1cm47XG5cblx0XHRuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3N3LmpzJywge3Njb3BlOiAnLyd9KS50aGVuKChzd1JlZykgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coJ1xcblNlcnZpY2VXb3JrZXIgc3VjY2Vzc2Z1bGx5IHJlZ2lzdHJlZC4gU2NvcGVcXG4nLCBzd1JlZy5zY29wZSk7XG5cdFx0fSkuY2F0Y2goKGVycikgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coJ1xcblNlcnZpY2VXb3JrZXIgc3dSZWcgZmFpbGVkIDooXFxuJywgZXJyLm1lc3NhZ2UpO1xuXHRcdH0pO1xuXG5cdH1cbn07XG5cblxuTWFpbkNvbnRyb2xsZXIucHJvdG90eXBlLmZldGNoUmVzdGF1cmFudHMgPSBmdW5jdGlvbihjdWlzaW5lLCBuZWlnaGJvcmhvb2QpIHtcblx0dGhpcy5kYi5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvciFcblx0XHRcdGhhbmRsZUVycm9yKGVycm9yKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5yZXNldFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcblx0XHRcdHRoaXMuZmlsbFJlc3RhdXJhbnRzSFRNTCgpO1xuXHRcdFx0cmV0dXJuIHJlc3RhdXJhbnRzO1xuXHRcdH1cblx0fSk7XG59XG5cblxuLyoqXG4gKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyBhbmQgc2V0IHRoZWlyIEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5mZXRjaE5laWdoYm9yaG9vZHMgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5kYi5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XG5cdFx0aWYgKGVycm9yKSB7IC8vIEdvdCBhbiBlcnJvclxuXHRcdFx0aGFuZGxlRXJyb3IoZXJyb3IpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xuXHRcdFx0dGhpcy5maWxsTmVpZ2hib3Job29kc0hUTUwoKTtcblx0XHR9XG5cdH0pO1xufTtcblxuXG4vKipcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5maWxsTmVpZ2hib3Job29kc0hUTUwgPSBmdW5jdGlvbihuZWlnaGJvcmhvb2RzID0gdGhpcy5uZWlnaGJvcmhvb2RzKSB7XG5cdGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xuXHRuZWlnaGJvcmhvb2RzLmZvckVhY2gobmVpZ2hib3Job29kID0+IHtcblx0XHRjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcblx0XHRvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xuXHRcdG9wdGlvbi52YWx1ZSA9IG5laWdoYm9yaG9vZDtcblx0XHRzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBGZXRjaCBhbGwgY3Vpc2luZXMgYW5kIHNldCB0aGVpciBIVE1MLlxuICovXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuZmV0Y2hDdWlzaW5lcyA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLmRiLmZldGNoQ3Vpc2luZXMoKGVycm9yLCBjdWlzaW5lcykgPT4ge1xuXHRcdGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG5cdFx0XHRoYW5kbGVFcnJvcihlcnJvcik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3Vpc2luZXMgPSBjdWlzaW5lcztcblx0XHRcdHRoaXMuZmlsbEN1aXNpbmVzSFRNTCgpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxuICovXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuZmlsbEN1aXNpbmVzSFRNTCA9IGZ1bmN0aW9uKGN1aXNpbmVzID0gdGhpcy5jdWlzaW5lcykge1xuXHRjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0Jyk7XG5cdGN1aXNpbmVzLmZvckVhY2goY3Vpc2luZSA9PiB7XG5cdFx0Y29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG5cdFx0b3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XG5cdFx0b3B0aW9uLnZhbHVlID0gY3Vpc2luZTtcblx0XHRzZWxlY3QuYXBwZW5kKG9wdGlvbik7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBDbGVhciBjdXJyZW50IHJlc3RhdXJhbnRzLCB0aGVpciBIVE1MIGFuZCByZW1vdmUgdGhlaXIgbWFwIG1hcmtlcnMuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5yZXNldFJlc3RhdXJhbnRzID0gZnVuY3Rpb24ocmVzdGF1cmFudHMpIHtcblx0Ly8gUmVtb3ZlIGFsbCByZXN0YXVyYW50c1xuXHR0aGlzLnJlc3RhdXJhbnRzID0gW107XG5cdGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcblx0dWwuaW5uZXJIVE1MID0gJyc7XG5cblx0Ly8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xuXHR0aGlzLm1hcmtlcnMuZm9yRWFjaChtID0+IG0uc2V0TWFwKG51bGwpKTtcblx0dGhpcy5tYXJrZXJzID0gW107XG5cdHRoaXMucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcbn07XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cbiAqL1xuTWFpbkNvbnRyb2xsZXIucHJvdG90eXBlLmZpbGxSZXN0YXVyYW50c0hUTUwgPSBmdW5jdGlvbihyZXN0YXVyYW50cyA9IHRoaXMucmVzdGF1cmFudHMpIHtcblx0Y29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xuXHRyZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xuXHRcdHVsLmFwcGVuZCh0aGlzLmNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcblx0fSk7XG5cblx0VXRpbC5pbWdMYXp5TG9hZGVyKCcuaW1nLWxhenktbG9hZCcpO1xuXHRpZihzZWxmLmluaXRNYXApIHRoaXMuYWRkTWFya2Vyc1RvTWFwKCk7XG59O1xuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXG4gKi9cbk1haW5Db250cm9sbGVyLnByb3RvdHlwZS5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IGZ1bmN0aW9uKHJlc3RhdXJhbnQpIHtcblxuXHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGAke3Jlc3RhdXJhbnQubmFtZX0gLSAke3Jlc3RhdXJhbnQuY3Vpc2luZV90eXBlfSAtICR7cmVzdGF1cmFudC5hZGRyZXNzfWApO1xuXG5cdGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG5cdGltYWdlLmNsYXNzTmFtZSA9ICdpbWctbGF6eS1sb2FkIHJlc3RhdXJhbnQtaW1nJztcblx0aW1hZ2Uuc2V0QXR0cmlidXRlKCdkYXRhLXNyYycsIHRoaXMuZGIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIDYwMCkpO1xuXHRpbWFnZS5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9IC0gJHtyZXN0YXVyYW50LmN1aXNpbmVfdHlwZX0gQ3Vpc2luZWA7XG5cblx0bGkuYXBwZW5kKGltYWdlKTtcblxuXHRjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcblx0bmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cdGxpLmFwcGVuZChuYW1lKTtcblxuXHRjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRjdWlzaW5lLmNsYXNzTmFtZSA9ICdjdWlzaW5lLXR5cGUnO1xuXHRjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xuXHRsaS5hcHBlbmQoY3Vpc2luZSk7XG5cblx0Y29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XG5cdGxpLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xuXG5cdGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuXHRsaS5hcHBlbmQoYWRkcmVzcyk7XG5cblx0Y29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcblx0bW9yZS5pbm5lckhUTUwgPSAnVmlldyBEZXRhaWxzJztcblx0bW9yZS5ocmVmID0gdGhpcy5kYi51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuXHRsaS5hcHBlbmQobW9yZSk7XG5cblx0Ly8gY29uc3Qgc2hhcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cdC8vIHNoYXJlLmlubmVySFRNTCA9ICdTaGFyZSc7XG5cdC8vIHNoYXJlLmhyZWYgPSB0aGlzLmRiLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cdC8vIGxpLmFwcGVuZChzaGFyZSk7XG5cblx0cmV0dXJuIGxpO1xufTtcblxuLyoqXG4gKiBBZGQgbWFya2VycyBmb3IgY3VycmVudCByZXN0YXVyYW50cyB0byB0aGUgbWFwLlxuICovXG5NYWluQ29udHJvbGxlci5wcm90b3R5cGUuYWRkTWFya2Vyc1RvTWFwID0gZnVuY3Rpb24ocmVzdGF1cmFudHMgPSB0aGlzLnJlc3RhdXJhbnRzKSB7XG5cdHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XG5cdFx0Ly8gQWRkIG1hcmtlciB0byB0aGUgbWFwXG5cdFx0Y29uc3QgbWFya2VyID0gdGhpcy5kYi5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubWFwKTtcblx0XHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybDtcblx0XHR9KTtcblx0XHR0aGlzLm1hcmtlcnMucHVzaChtYXJrZXIpO1xuXHR9KTtcbn07XG5cblxuZnVuY3Rpb24gY2hlY2tDb25uZWN0aW9uKCkge1xuXHRpZighbmF2aWdhdG9yLm9uTGluZSkgaGFuZGxlRXJyb3IobmV3IEVycm9yKCdObyBDb25uZWN0aW9uJykpO1xuXHQvLyBjaGVjayBjb25uZXRpb24gZXZlcnkgNSBzZWNvbmRzXG5cdGNvbnN0IGNoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdGNoZWNrQ29ubmVjdGlvbigpO1xuICB9LCAxMDAwMCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yKSB7XG5cdFV0aWwuc25hY2tiYXIoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3NuYWNrYmFyJyksIGVycm9yLm1lc3NhZ2UpO1xufVxuXG4iLCIvLyBVdGlsaXR5IGZ1bmN0aW9uc1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFV0aWwge1xuXG5cdC8qKlxuXHQqXG5cdCovXG5cdHN0YXRpYyBzbmFja2JhcihlbCwgbWVzc2FnZSwgY29sb3IgPSAnI0Q5MDAxRicpIHtcblxuXHRcdC8vIFRPRE9cblx0XHQvLyBDcmVhdGUgYSBlbGVtZW50IGlmIHRoZSBzZWxlY3RlZCBlbGVtZW50IGRvZXMgbm90IGV4aXN0ZVxuXHRcdC8vIHZhciBuZXdEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpOyBcblxuXHRcdGlmKCFlbCkge1xuXHRcdFx0Y29uc29sZS5sb2cobmV3IEVycm9yKCdTbmFja2JhciBlbGVtZW50IG5vdCB2YWxpZCcpKTsgXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0ZWwuaW5uZXJIVE1MID0gbWVzc2FnZTtcblx0XHRlbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3Nob3cnKTtcblx0XHRlbC5zdHlsZS5iYWNrZ3JvdW5kID0gY29sb3I7XG5cdFx0c2V0VGltZW91dCgoKSA9PiB7IGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKSB9LCA1NTAwKTtcblx0fVxuXG5cblx0LyoqXG5cdCpcblx0Ki9cblx0c3RhdGljIGltZ0xhenlMb2FkZXIodGFyZ2V0KSB7XG5cdFx0Y29uc3QgaW1ncyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGFyZ2V0KTtcblxuXHRcdGlmKCF3aW5kb3cuSW50ZXJzZWN0aW9uT2JzZXJ2ZXIpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdObyBsYXp5IGxvYWRpbmcgZm9yIHlvdSA6KCcpO1xuXHRcdFx0aW1ncy5mb3JFYWNoKGltZyA9PiBVdGlsLnByZWxvYWRJbWFnZShpbWcpKTtcblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRjb25zdCBvbkludGVyc2VjdGlvbiA9IGZ1bmN0aW9uIChlbnRyaWVzLCBvYnNyKSB7XG5cdFx0XHRcdGVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7XG5cdFx0XHRcdFx0aWYgKGVudHJ5LmludGVyc2VjdGlvblJhdGlvID4gMCkge1xuXHRcdFx0XHRcdFx0b2Jzci51bm9ic2VydmUoZW50cnkudGFyZ2V0KTtcblx0XHRcdFx0XHRcdFV0aWwucHJlbG9hZEltYWdlKGVudHJ5LnRhcmdldCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0ICB9KTtcblx0XHRcdH07XG5cblx0XHRcdGNvbnN0IG9ic3JPcHRpb25zID0ge1xuXHRcdFx0XHRyb290TWFyZ2luOiAnMzBweCAwcHgnLFxuXHQgIFx0XHR0aHJlc2hvbGQ6IFswLjFdXG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKG9uSW50ZXJzZWN0aW9uLCBvYnNyT3B0aW9ucyk7XG5cdFx0XHRpbWdzLmZvckVhY2godGFyZ2V0ID0+IG9ic2VydmVyLm9ic2VydmUodGFyZ2V0KSk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCpcblx0Ki9cblx0c3RhdGljIHByZWxvYWRJbWFnZSh0YXJnZXQpIHtcblx0XHRpZighdGFyZ2V0Lm5vZGVOYW1lID09PSAnSU1HJykgcmV0dXJuIGZhbHNlO1xuXHRcdHRhcmdldC5zZXRBdHRyaWJ1dGUoJ3NyYycsIHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3JjJykpO1xuXHRcdGNvbnNvbGUubG9nKCdJbWFnZSBsb2FkZWQ6ICcsdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKSk7XG5cdFx0cmV0dXJuIHRhcmdldDtcblx0fVxuXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gdG9BcnJheShhcnIpIHtcbiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUocmVxdWVzdC5yZXN1bHQpO1xuICAgICAgfTtcblxuICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciByZXF1ZXN0O1xuICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0ID0gb2JqW21ldGhvZF0uYXBwbHkob2JqLCBhcmdzKTtcbiAgICAgIHByb21pc2lmeVJlcXVlc3QocmVxdWVzdCkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgIH0pO1xuXG4gICAgcC5yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgICByZXR1cm4gcDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncyk7XG4gICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIHAucmVxdWVzdCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVByb3BlcnRpZXMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUHJveHlDbGFzcy5wcm90b3R5cGUsIHByb3AsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICB0aGlzW3RhcmdldFByb3BdW3Byb3BdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eU1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpc1t0YXJnZXRQcm9wXVtwcm9wXS5hcHBseSh0aGlzW3RhcmdldFByb3BdLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoUHJveHlDbGFzcywgdGFyZ2V0UHJvcCwgQ29uc3RydWN0b3IsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgaWYgKCEocHJvcCBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgICBQcm94eUNsYXNzLnByb3RvdHlwZVtwcm9wXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwodGhpc1t0YXJnZXRQcm9wXSwgcHJvcCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBJbmRleChpbmRleCkge1xuICAgIHRoaXMuX2luZGV4ID0gaW5kZXg7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoSW5kZXgsICdfaW5kZXgnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnbXVsdGlFbnRyeScsXG4gICAgJ3VuaXF1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ2dldCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhJbmRleCwgJ19pbmRleCcsIElEQkluZGV4LCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBmdW5jdGlvbiBDdXJzb3IoY3Vyc29yLCByZXF1ZXN0KSB7XG4gICAgdGhpcy5fY3Vyc29yID0gY3Vyc29yO1xuICAgIHRoaXMuX3JlcXVlc3QgPSByZXF1ZXN0O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEN1cnNvciwgJ19jdXJzb3InLCBbXG4gICAgJ2RpcmVjdGlvbicsXG4gICAgJ2tleScsXG4gICAgJ3ByaW1hcnlLZXknLFxuICAgICd2YWx1ZSdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhDdXJzb3IsICdfY3Vyc29yJywgSURCQ3Vyc29yLCBbXG4gICAgJ3VwZGF0ZScsXG4gICAgJ2RlbGV0ZSdcbiAgXSk7XG5cbiAgLy8gcHJveHkgJ25leHQnIG1ldGhvZHNcbiAgWydhZHZhbmNlJywgJ2NvbnRpbnVlJywgJ2NvbnRpbnVlUHJpbWFyeUtleSddLmZvckVhY2goZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIGlmICghKG1ldGhvZE5hbWUgaW4gSURCQ3Vyc29yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICBDdXJzb3IucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgY3Vyc29yID0gdGhpcztcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgIGN1cnNvci5fY3Vyc29yW21ldGhvZE5hbWVdLmFwcGx5KGN1cnNvci5fY3Vyc29yLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QoY3Vyc29yLl9yZXF1ZXN0KS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgaWYgKCF2YWx1ZSkgcmV0dXJuO1xuICAgICAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBjdXJzb3IuX3JlcXVlc3QpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIE9iamVjdFN0b3JlKHN0b3JlKSB7XG4gICAgdGhpcy5fc3RvcmUgPSBzdG9yZTtcbiAgfVxuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5jcmVhdGVJbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuY3JlYXRlSW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIE9iamVjdFN0b3JlLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgSW5kZXgodGhpcy5fc3RvcmUuaW5kZXguYXBwbHkodGhpcy5fc3RvcmUsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdpbmRleE5hbWVzJyxcbiAgICAnYXV0b0luY3JlbWVudCdcbiAgXSk7XG5cbiAgcHJveHlSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ3B1dCcsXG4gICAgJ2FkZCcsXG4gICAgJ2RlbGV0ZScsXG4gICAgJ2NsZWFyJyxcbiAgICAnZ2V0JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ2RlbGV0ZUluZGV4J1xuICBdKTtcblxuICBmdW5jdGlvbiBUcmFuc2FjdGlvbihpZGJUcmFuc2FjdGlvbikge1xuICAgIHRoaXMuX3R4ID0gaWRiVHJhbnNhY3Rpb247XG4gICAgdGhpcy5jb21wbGV0ZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uYWJvcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBUcmFuc2FjdGlvbi5wcm90b3R5cGUub2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX3R4Lm9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX3R4LCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVHJhbnNhY3Rpb24sICdfdHgnLCBbXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnLFxuICAgICdtb2RlJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVHJhbnNhY3Rpb24sICdfdHgnLCBJREJUcmFuc2FjdGlvbiwgW1xuICAgICdhYm9ydCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVXBncmFkZURCKGRiLCBvbGRWZXJzaW9uLCB0cmFuc2FjdGlvbikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gICAgdGhpcy5vbGRWZXJzaW9uID0gb2xkVmVyc2lvbjtcbiAgICB0aGlzLnRyYW5zYWN0aW9uID0gbmV3IFRyYW5zYWN0aW9uKHRyYW5zYWN0aW9uKTtcbiAgfVxuXG4gIFVwZ3JhZGVEQi5wcm90b3R5cGUuY3JlYXRlT2JqZWN0U3RvcmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IE9iamVjdFN0b3JlKHRoaXMuX2RiLmNyZWF0ZU9iamVjdFN0b3JlLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoVXBncmFkZURCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhVcGdyYWRlREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdkZWxldGVPYmplY3RTdG9yZScsXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICBmdW5jdGlvbiBEQihkYikge1xuICAgIHRoaXMuX2RiID0gZGI7XG4gIH1cblxuICBEQi5wcm90b3R5cGUudHJhbnNhY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFRyYW5zYWN0aW9uKHRoaXMuX2RiLnRyYW5zYWN0aW9uLmFwcGx5KHRoaXMuX2RiLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKERCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIC8vIEFkZCBjdXJzb3IgaXRlcmF0b3JzXG4gIC8vIFRPRE86IHJlbW92ZSB0aGlzIG9uY2UgYnJvd3NlcnMgZG8gdGhlIHJpZ2h0IHRoaW5nIHdpdGggcHJvbWlzZXNcbiAgWydvcGVuQ3Vyc29yJywgJ29wZW5LZXlDdXJzb3InXS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmNOYW1lKSB7XG4gICAgW09iamVjdFN0b3JlLCBJbmRleF0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgICAgLy8gRG9uJ3QgY3JlYXRlIGl0ZXJhdGVLZXlDdXJzb3IgaWYgb3BlbktleUN1cnNvciBkb2Vzbid0IGV4aXN0LlxuICAgICAgaWYgKCEoZnVuY05hbWUgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuXG4gICAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGVbZnVuY05hbWUucmVwbGFjZSgnb3BlbicsICdpdGVyYXRlJyldID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gdG9BcnJheShhcmd1bWVudHMpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG4gICAgICAgIHZhciBuYXRpdmVPYmplY3QgPSB0aGlzLl9zdG9yZSB8fCB0aGlzLl9pbmRleDtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBuYXRpdmVPYmplY3RbZnVuY05hbWVdLmFwcGx5KG5hdGl2ZU9iamVjdCwgYXJncy5zbGljZSgwLCAtMSkpO1xuICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGNhbGxiYWNrKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgICAgfTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIHBvbHlmaWxsIGdldEFsbFxuICBbSW5kZXgsIE9iamVjdFN0b3JlXS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgaWYgKENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwpIHJldHVybjtcbiAgICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsID0gZnVuY3Rpb24ocXVlcnksIGNvdW50KSB7XG4gICAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgICAgdmFyIGl0ZW1zID0gW107XG5cbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgICAgIGluc3RhbmNlLml0ZXJhdGVDdXJzb3IocXVlcnksIGZ1bmN0aW9uKGN1cnNvcikge1xuICAgICAgICAgIGlmICghY3Vyc29yKSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgaXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xuXG4gICAgICAgICAgaWYgKGNvdW50ICE9PSB1bmRlZmluZWQgJiYgaXRlbXMubGVuZ3RoID09IGNvdW50KSB7XG4gICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgdmFyIGV4cCA9IHtcbiAgICBvcGVuOiBmdW5jdGlvbihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnb3BlbicsIFtuYW1lLCB2ZXJzaW9uXSk7XG4gICAgICB2YXIgcmVxdWVzdCA9IHAucmVxdWVzdDtcblxuICAgICAgaWYgKHJlcXVlc3QpIHtcbiAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgIGlmICh1cGdyYWRlQ2FsbGJhY2spIHtcbiAgICAgICAgICAgIHVwZ3JhZGVDYWxsYmFjayhuZXcgVXBncmFkZURCKHJlcXVlc3QucmVzdWx0LCBldmVudC5vbGRWZXJzaW9uLCByZXF1ZXN0LnRyYW5zYWN0aW9uKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKGRiKSB7XG4gICAgICAgIHJldHVybiBuZXcgREIoZGIpO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGU6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdkZWxldGVEYXRhYmFzZScsIFtuYW1lXSk7XG4gICAgfVxuICB9O1xuXG4gIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZXhwO1xuICAgIG1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0cztcbiAgfVxuICBlbHNlIHtcbiAgICBzZWxmLmlkYiA9IGV4cDtcbiAgfVxufSgpKTtcbiJdfQ==\n"]}