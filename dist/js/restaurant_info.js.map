{"version":3,"sources":["restaurant_info.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","obj","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_idb","_idb2","__esModule","default","DBHelper","instance","TypeError","_classCallCheck","this","_IDB","openDatabase","get","navigator","serviceWorker","open","upgradedDB","oldVersion","createObjectStore","keyPath","createIndex","console","log","Promise","resolve","restaurants","arguments","undefined","then","db","tx","transaction","readwriteStore","objectStore","forEach","restaurant","put","complete","index","getAll","rreview","callback","_this","loadCache","data","fetch","DATABASE_URL","response","status","json","cacheData","handleResponseError","catch","error","id","fetchRestaurants","find","cuisine","results","filter","cuisine_type","neighborhood","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","size","img","photograph","google","maps","Marker","position","latlng","title","name","url","urlForRestaurant","animation","Animation","DROP","type","idb","2","_dbhelper","_dbhelper2","RestaurantInfo","window","initMap","fetchRestaurantFromURL","Map","document","getElementById","zoom","center","scrollwheel","fillBreadcrumb","mapMarkerForRestaurant","_this2","getParameterByName","fetchRestaurantById","fillRestaurantHTML","innerHTML","address","image","className","src","imageUrlForRestaurant","alt","srcset","operating_hours","fillRestaurantHoursHTML","fillReviewsHTML","operatingHours","hours","row","createElement","day","appendChild","time","_this3","reviews","container","noReviews","ul","review","createReviewHTML","li","date","rating","comments","breadcrumb","setAttribute","location","href","replace","RegExp","exec","decodeURIComponent","restaurantInfo","./dbhelper","3","promisifyRequest","request","reject","onsuccess","result","onerror","promisifyRequestCall","method","args","apply","proxyProperties","ProxyClass","targetProp","properties","prop","set","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Cursor","Index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","arr","Array","slice","nativeObject","query","count","items","iterateCursor","push","continue","exp","version","upgradeCallback","indexedDB","onupgradeneeded","event","delete","self"],"mappings":"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","file":"restaurant_info.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _idb = require('idb');\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\n* Common database helper functions.\n*/\nvar DBHelper = function () {\n\t_createClass(DBHelper, [{\n\t\tkey: 'DATABASE_URL',\n\n\n\t\t/**\n   * Database URL.\n   * Change this to restaurants.json file location on your server.\n   */\n\t\tget: function get() {\n\t\t\tvar port = 1337; // Change this to your server port\n\t\t\treturn 'http://localhost:' + port + '/restaurants';\n\t\t}\n\t}]);\n\n\tfunction DBHelper() {\n\t\t_classCallCheck(this, DBHelper);\n\n\t\tthis._IDB = this.openDatabase();\n\t}\n\n\t_createClass(DBHelper, [{\n\t\tkey: 'openDatabase',\n\t\tvalue: function openDatabase() {\n\t\t\tif (!navigator.serviceWorker) return Promise.resolve();\n\n\t\t\treturn _idb2.default.open('rreview', 1, function (upgradedDB) {\n\t\t\t\tswitch (upgradedDB.oldVersion) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tvar rreview = upgradedDB.createObjectStore('rreview', { keyPath: 'id' });\n\t\t\t\t\t\tvar index = rreview.createIndex('by-id', 'id');\n\t\t\t\t\t\tconsole.log('Database and Index created');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'cacheData',\n\t\tvalue: function cacheData() {\n\t\t\tvar restaurants = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n\t\t\t// add post the local DB\n\t\t\tthis._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\n\t\t\t\tvar tx = db.transaction('rreview', 'readwrite');\n\t\t\t\tvar readwriteStore = tx.objectStore('rreview');\n\t\t\t\trestaurants.forEach(function (restaurant) {\n\t\t\t\t\treturn readwriteStore.put(restaurant);\n\t\t\t\t});\n\t\t\t\ttx.complete.then(function () {\n\t\t\t\t\treturn console.log('post added to indexedDB');\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n  * Load data from the client database.\n  */\n\n\t}, {\n\t\tkey: 'loadCache',\n\t\tvalue: function loadCache() {\n\t\t\treturn this._IDB.then(function (db) {\n\t\t\t\tif (!db) return;\n\t\t\t\treturn db.transaction('rreview').objectStore('rreview').index('by-id').getAll();\n\t\t\t}).then(function (rreview) {\n\t\t\t\treturn rreview;\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'fetchRestaurants',\n\n\n\t\t/** TODO\n  * Implement Socket to load real times database loads\n  */\n\n\t\t/**\n   * Fetch all restaurants.\n   */\n\t\tvalue: function fetchRestaurants(callback) {\n\t\t\tvar _this = this;\n\n\t\t\tthis.loadCache().then(function (data) {\n\t\t\t\tif (data.length > 0) {\n\t\t\t\t\tcallback(null, data);\n\t\t\t\t} else {\n\n\t\t\t\t\tfetch(_this.DATABASE_URL).then(function (response) {\n\t\t\t\t\t\tif (response.status === 200) {\n\t\t\t\t\t\t\tresponse.json().then(function (data) {\n\t\t\t\t\t\t\t\t_this.cacheData(data);\n\t\t\t\t\t\t\t\tcallback(null, data);\n\t\t\t\t\t\t\t\tconsole.log('data loaded from local storage!');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcallback(_this.handleResponseError(response, 'api request'), null);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(function (error) {\n\t\t\t\t\t\treturn callback(error, null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch a restaurant by its ID.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantById',\n\t\tvalue: function fetchRestaurantById(id, callback) {\n\t\t\t// fetch all restaurants with proper error handling.\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\n\t\t\t\t\tvar restaurant = restaurants.find(function (r) {\n\t\t\t\t\t\treturn r.id == id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (restaurant) {\n\t\t\t\t\t\t// Got the restaurant\n\t\t\t\t\t\tcallback(null, restaurant);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Restaurant does not exist in the database\n\t\t\t\t\t\tcallback('Restaurant does not exist', null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine type with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisine',\n\t\tvalue: function fetchRestaurantByCuisine(cuisine, callback) {\n\t\t\t// Fetch all restaurants\twith proper error handling\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given cuisine type\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByNeighborhood',\n\t\tvalue: function fetchRestaurantByNeighborhood(neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Filter restaurants to have only given neighborhood\n\t\t\t\t\tvar results = restaurants.filter(function (r) {\n\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchRestaurantByCuisineAndNeighborhood',\n\t\tvalue: function fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\tvar results = restaurants;\n\t\t\t\t\tif (cuisine != 'all') {\n\t\t\t\t\t\t// filter by cuisine\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.cuisine_type == cuisine;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (neighborhood != 'all') {\n\t\t\t\t\t\t// filter by neighborhood\n\t\t\t\t\t\tresults = results.filter(function (r) {\n\t\t\t\t\t\t\treturn r.neighborhood == neighborhood;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tcallback(null, results);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all neighborhoods with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchNeighborhoods',\n\t\tvalue: function fetchNeighborhoods(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all neighborhoods from all restaurants\n\t\t\t\t\tvar neighborhoods = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].neighborhood;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from neighborhoods\n\t\t\t\t\tvar uniqueNeighborhoods = neighborhoods.filter(function (v, i) {\n\t\t\t\t\t\treturn neighborhoods.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueNeighborhoods);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Fetch all cuisines with proper error handling.\n   */\n\n\t}, {\n\t\tkey: 'fetchCuisines',\n\t\tvalue: function fetchCuisines(callback) {\n\t\t\t// Fetch all restaurants\n\t\t\tthis.fetchRestaurants(function (error, restaurants) {\n\t\t\t\tif (error) {\n\t\t\t\t\tcallback(error, null);\n\t\t\t\t} else {\n\t\t\t\t\t// Get all cuisines from all restaurants\n\t\t\t\t\tvar cuisines = restaurants.map(function (v, i) {\n\t\t\t\t\t\treturn restaurants[i].cuisine_type;\n\t\t\t\t\t});\n\t\t\t\t\t// Remove duplicates from cuisines\n\t\t\t\t\tvar uniqueCuisines = cuisines.filter(function (v, i) {\n\t\t\t\t\t\treturn cuisines.indexOf(v) == i;\n\t\t\t\t\t});\n\t\t\t\t\tcallback(null, uniqueCuisines);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t/**\n   * Restaurant page URL.\n   */\n\n\t}, {\n\t\tkey: 'urlForRestaurant',\n\t\tvalue: function urlForRestaurant(restaurant) {\n\t\t\treturn './restaurant.html?id=' + restaurant.id;\n\t\t}\n\t\t/**\n   * Restaurant image URL.\n   */\n\n\t}, {\n\t\tkey: 'imageUrlForRestaurant',\n\t\tvalue: function imageUrlForRestaurant(restaurant, size) {\n\t\t\tvar img = restaurant.photograph;\n\t\t\treturn img ? '/img/' + img + '-' + size + '.jpg' : '/img/restaurant_placeholder.svg';\n\t\t}\n\t\t/**\n   * Map marker for a restaurant.\n   */\n\n\t}, {\n\t\tkey: 'mapMarkerForRestaurant',\n\t\tvalue: function mapMarkerForRestaurant(restaurant, map) {\n\t\t\tvar marker = new google.maps.Marker({\n\t\t\t\tposition: restaurant.latlng,\n\t\t\t\ttitle: restaurant.name,\n\t\t\t\turl: this.urlForRestaurant(restaurant),\n\t\t\t\tmap: map,\n\t\t\t\tanimation: google.maps.Animation.DROP });\n\t\t\treturn marker;\n\t\t}\n\t}, {\n\t\tkey: 'handleResponseError',\n\t\tvalue: function handleResponseError(response, type) {\n\t\t\tswitch (response.status) {\n\t\t\t\tcase 400:\n\t\t\t\t\treturn new Error('Bed request');\n\t\t\t\tcase 404:\n\t\t\t\t\treturn new Error('Not found');\n\t\t\t\tcase 500:\n\t\t\t\t\treturn new Error('Internal server error');\n\t\t\t}\n\t\t}\n\t}]);\n\n\treturn DBHelper;\n}();\n\nexports.default = DBHelper;\n\n},{\"idb\":3}],2:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _dbhelper = require('./dbhelper');\n\nvar _dbhelper2 = _interopRequireDefault(_dbhelper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar RestaurantInfo = function () {\n\tfunction RestaurantInfo() {\n\t\tvar _this = this;\n\n\t\t_classCallCheck(this, RestaurantInfo);\n\n\t\tthis.map = null;\n\t\tthis.restaurant = null;\n\t\tthis.db = new _dbhelper2.default();\n\n\t\t/**\n   * Initialize Google map, called from HTML.\n   */\n\t\twindow.initMap = function () {\n\t\t\t_this.fetchRestaurantFromURL(function (error, restaurant) {\n\t\t\t\tif (error) {\n\t\t\t\t\t// Got an error!\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t} else {\n\t\t\t\t\t_this.map = new google.maps.Map(document.getElementById('map'), {\n\t\t\t\t\t\tzoom: 16,\n\t\t\t\t\t\tcenter: restaurant.latlng,\n\t\t\t\t\t\tscrollwheel: false\n\t\t\t\t\t});\n\t\t\t\t\t_this.fillBreadcrumb();\n\t\t\t\t\t_this.db.mapMarkerForRestaurant(_this.restaurant, _this.map);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n  * Get current restaurant from page URL.\n  */\n\n\n\t_createClass(RestaurantInfo, [{\n\t\tkey: 'fetchRestaurantFromURL',\n\t\tvalue: function fetchRestaurantFromURL(callback) {\n\t\t\tvar _this2 = this;\n\n\t\t\tif (this.restaurant) {\n\t\t\t\t// restaurant already fetched!\n\t\t\t\tcallback(null, this.restaurant);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar id = this.getParameterByName('id');\n\t\t\tif (!id) {\n\t\t\t\t// no id found in URL\n\t\t\t\tcallback('No restaurant id in URL', null);\n\t\t\t} else {\n\t\t\t\tthis.db.fetchRestaurantById(id, function (error, restaurant) {\n\t\t\t\t\t_this2.restaurant = restaurant;\n\t\t\t\t\tif (!restaurant) {\n\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t_this2.fillRestaurantHTML();\n\t\t\t\t\tcallback(null, restaurant);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'fillRestaurantHTML',\n\n\n\t\t/**\n   * Create restaurant HTML and add it to the webpage\n   */\n\t\tvalue: function fillRestaurantHTML() {\n\t\t\tvar restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurant;\n\n\t\t\tvar name = document.getElementById('restaurant-name');\n\t\t\tname.innerHTML = restaurant.name;\n\n\t\t\tvar address = document.getElementById('restaurant-address');\n\t\t\taddress.innerHTML = restaurant.address;\n\n\t\t\tvar image = document.getElementById('restaurant-img');\n\t\t\timage.className = 'restaurant-img';\n\t\t\timage.src = this.db.imageUrlForRestaurant(restaurant, 600);\n\t\t\timage.alt = 'Photo of ' + restaurant.name + ' restaurant';\n\t\t\timage.srcset = this.db.imageUrlForRestaurant(restaurant, 1200) + ' 1200w, ' + this.db.imageUrlForRestaurant(restaurant, 600) + ' 600w';\n\n\t\t\tvar cuisine = document.getElementById('restaurant-cuisine');\n\t\t\tcuisine.innerHTML = restaurant.cuisine_type;\n\n\t\t\t// fill operating hours\n\t\t\tif (restaurant.operating_hours) {\n\t\t\t\tthis.fillRestaurantHoursHTML();\n\t\t\t}\n\t\t\t// fill reviews\n\t\t\tthis.fillReviewsHTML();\n\t\t}\n\t}, {\n\t\tkey: 'fillRestaurantHoursHTML',\n\n\n\t\t/**\n   * Create restaurant operating hours HTML table and add it to the webpage.\n   */\n\t\tvalue: function fillRestaurantHoursHTML() {\n\t\t\tvar operatingHours = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurant.operating_hours;\n\n\t\t\tvar hours = document.getElementById('restaurant-hours');\n\t\t\tfor (var key in operatingHours) {\n\t\t\t\tvar row = document.createElement('tr');\n\n\t\t\t\tvar day = document.createElement('td');\n\t\t\t\tday.innerHTML = key;\n\t\t\t\trow.appendChild(day);\n\n\t\t\t\tvar time = document.createElement('td');\n\t\t\t\ttime.innerHTML = operatingHours[key];\n\t\t\t\trow.appendChild(time);\n\n\t\t\t\thours.appendChild(row);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'fillReviewsHTML',\n\n\n\t\t/**\n   * Create all reviews HTML and add them to the webpage.\n   */\n\t\tvalue: function fillReviewsHTML() {\n\t\t\tvar _this3 = this;\n\n\t\t\tvar reviews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurant.reviews;\n\n\t\t\tvar container = document.getElementById('reviews-container');\n\t\t\tvar title = document.createElement('h3');\n\t\t\ttitle.innerHTML = 'Reviews';\n\t\t\tcontainer.appendChild(title);\n\n\t\t\tif (!reviews) {\n\t\t\t\tvar noReviews = document.createElement('p');\n\t\t\t\tnoReviews.innerHTML = 'No reviews yet!';\n\t\t\t\tcontainer.appendChild(noReviews);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar ul = document.getElementById('reviews-list');\n\t\t\treviews.forEach(function (review) {\n\t\t\t\tul.appendChild(_this3.createReviewHTML(review));\n\t\t\t});\n\t\t\tcontainer.appendChild(ul);\n\t\t}\n\t}, {\n\t\tkey: 'createReviewHTML',\n\n\n\t\t/**\n   * Create review HTML and add it to the webpage.\n   */\n\t\tvalue: function createReviewHTML(review) {\n\t\t\tvar li = document.createElement('li');\n\t\t\tvar name = document.createElement('p');\n\t\t\tname.innerHTML = review.name;\n\t\t\tli.appendChild(name);\n\n\t\t\tvar date = document.createElement('p');\n\t\t\tdate.innerHTML = review.date;\n\t\t\tli.appendChild(date);\n\n\t\t\tvar rating = document.createElement('p');\n\t\t\trating.innerHTML = 'Rating: ' + review.rating;\n\t\t\tli.appendChild(rating);\n\n\t\t\tvar comments = document.createElement('p');\n\t\t\tcomments.innerHTML = review.comments;\n\t\t\tli.appendChild(comments);\n\n\t\t\treturn li;\n\t\t}\n\t}, {\n\t\tkey: 'fillBreadcrumb',\n\n\n\t\t/**\n   * Add restaurant name to the breadcrumb navigation menu\n   */\n\t\tvalue: function fillBreadcrumb() {\n\t\t\tvar restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.restaurant;\n\n\t\t\tvar breadcrumb = document.getElementById('breadcrumb');\n\t\t\tvar li = document.createElement('li');\n\t\t\tli.innerHTML = restaurant.name;\n\t\t\tli.setAttribute('aria-label', restaurant.name);\n\t\t\tli.setAttribute('aria-current', 'page');\n\t\t\tbreadcrumb.appendChild(li);\n\t\t}\n\t}, {\n\t\tkey: 'getParameterByName',\n\n\n\t\t/**\n   * Get a parameter by name from page URL.\n   */\n\t\tvalue: function getParameterByName(name, url) {\n\t\t\tif (!url) url = window.location.href;\n\t\t\tname = name.replace(/[\\[\\]]/g, '\\\\$&');\n\t\t\tvar regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n\t\t\t    results = regex.exec(url);\n\t\t\tif (!results) return null;\n\t\t\tif (!results[2]) return '';\n\t\t\treturn decodeURIComponent(results[2].replace(/\\+/g, ' '));\n\t\t}\n\t}]);\n\n\treturn RestaurantInfo;\n}();\n\nexports.default = RestaurantInfo;\n\n\nwindow.restaurantInfo = new RestaurantInfo();\n\n},{\"./dbhelper\":1}],3:[function(require,module,exports){\n'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n},{}]},{},[2])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kYmhlbHBlci5qcyIsImpzL3Jlc3RhdXJhbnRfaW5mby5qcyIsIm5vZGVfbW9kdWxlcy9pZGIvbGliL2lkYi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0FDQUE7Ozs7Ozs7O0FBRUE7OztJQUdxQixROzs7OztBQUVwQjs7OztzQkFJbUI7QUFDbEIsT0FBTSxPQUFPLElBQWIsQ0FEa0IsQ0FDQztBQUNuQixnQ0FBMkIsSUFBM0I7QUFDQTs7O0FBRUQscUJBQWE7QUFBQTs7QUFDWixPQUFLLElBQUwsR0FBWSxLQUFLLFlBQUwsRUFBWjtBQUNBOzs7O2lDQUVjO0FBQ2QsT0FBSSxDQUFDLFVBQVUsYUFBZixFQUE4QixPQUFPLFFBQVEsT0FBUixFQUFQOztBQUU5QixVQUFPLGNBQUksSUFBSixDQUFTLFNBQVQsRUFBb0IsQ0FBcEIsRUFBdUIsVUFBQyxVQUFELEVBQWdCO0FBQzdDLFlBQU8sV0FBVyxVQUFsQjtBQUNBLFVBQUssQ0FBTDtBQUNDLFVBQU0sVUFBVSxXQUFXLGlCQUFYLENBQTZCLFNBQTdCLEVBQXdDLEVBQUMsU0FBUyxJQUFWLEVBQXhDLENBQWhCO0FBQ0EsVUFBTSxRQUFRLFFBQVEsV0FBUixDQUFvQixPQUFwQixFQUE2QixJQUE3QixDQUFkO0FBQ0EsY0FBUSxHQUFSLENBQVksNEJBQVo7QUFKRDtBQU1BLElBUE0sQ0FBUDtBQVFBOzs7OEJBRTBCO0FBQUEsT0FBakIsV0FBaUIsdUVBQUgsRUFBRzs7QUFDekI7QUFDRCxRQUFLLElBQUwsQ0FBVSxJQUFWLENBQWUsY0FBTTtBQUNwQixRQUFJLENBQUMsRUFBTCxFQUFTOztBQUVULFFBQU0sS0FBSyxHQUFHLFdBQUgsQ0FBZSxTQUFmLEVBQTBCLFdBQTFCLENBQVg7QUFDQSxRQUFNLGlCQUFpQixHQUFHLFdBQUgsQ0FBZSxTQUFmLENBQXZCO0FBQ0EsZ0JBQVksT0FBWixDQUFvQixVQUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW1wb3J0IElEQiBmcm9tICdpZGInO1xuXG4vKlxuKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cbiovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEQkhlbHBlciB7XG5cblx0LyoqXG5cdCAqIERhdGFiYXNlIFVSTC5cblx0ICogQ2hhbmdlIHRoaXMgdG8gcmVzdGF1cmFudHMuanNvbiBmaWxlIGxvY2F0aW9uIG9uIHlvdXIgc2VydmVyLlxuXHQgKi9cblx0Z2V0IERBVEFCQVNFX1VSTCgpIHtcblx0XHRjb25zdCBwb3J0ID0gMTMzNzsgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBzZXJ2ZXIgcG9ydFxuXHRcdHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9L3Jlc3RhdXJhbnRzYDtcblx0fVxuXG5cdGNvbnN0cnVjdG9yKCl7XG5cdFx0dGhpcy5fSURCID0gdGhpcy5vcGVuRGF0YWJhc2UoKTtcblx0fVxuXG5cdG9wZW5EYXRhYmFzZSgpIHtcblx0XHRpZiAoIW5hdmlnYXRvci5zZXJ2aWNlV29ya2VyKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG5cblx0XHRyZXR1cm4gSURCLm9wZW4oJ3JyZXZpZXcnLCAxLCAodXBncmFkZWREQikgPT4ge1xuXHRcdFx0c3dpdGNoKHVwZ3JhZGVkREIub2xkVmVyc2lvbil7XG5cdFx0XHRjYXNlIDA6IFxuXHRcdFx0XHRjb25zdCBycmV2aWV3ID0gdXBncmFkZWREQi5jcmVhdGVPYmplY3RTdG9yZSgncnJldmlldycsIHtrZXlQYXRoOiAnaWQnfSk7XG5cdFx0XHRcdGNvbnN0IGluZGV4ID0gcnJldmlldy5jcmVhdGVJbmRleCgnYnktaWQnLCAnaWQnKTtcblx0XHRcdFx0Y29uc29sZS5sb2coJ0RhdGFiYXNlIGFuZCBJbmRleCBjcmVhdGVkJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRjYWNoZURhdGEocmVzdGF1cmFudHMgPSBbXSl7XG5cdFx0IC8vIGFkZCBwb3N0IHRoZSBsb2NhbCBEQlxuXHRcdHRoaXMuX0lEQi50aGVuKGRiID0+IHtcblx0XHRcdGlmICghZGIpIHJldHVybjtcblxuXHRcdFx0Y29uc3QgdHggPSBkYi50cmFuc2FjdGlvbigncnJldmlldycsICdyZWFkd3JpdGUnKTtcblx0XHRcdGNvbnN0IHJlYWR3cml0ZVN0b3JlID0gdHgub2JqZWN0U3RvcmUoJ3JyZXZpZXcnKTtcblx0XHRcdHJlc3RhdXJhbnRzLmZvckVhY2goKHJlc3RhdXJhbnQpID0+IHJlYWR3cml0ZVN0b3JlLnB1dChyZXN0YXVyYW50KSk7XG5cdFx0XHR0eC5jb21wbGV0ZS50aGVuKCgpID0+IGNvbnNvbGUubG9nKCdwb3N0IGFkZGVkIHRvIGluZGV4ZWREQicpKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuICogTG9hZCBkYXRhIGZyb20gdGhlIGNsaWVudCBkYXRhYmFzZS5cbiAqL1xuXHRsb2FkQ2FjaGUoKSB7XG5cdFx0cmV0dXJuIHRoaXMuX0lEQi50aGVuKGRiID0+IHtcblx0XHRcdGlmICghZGIpIHJldHVybjtcblx0XHRcdHJldHVybiBkYi50cmFuc2FjdGlvbigncnJldmlldycpXG5cdFx0XHRcdC5vYmplY3RTdG9yZSgncnJldmlldycpXG5cdFx0XHRcdC5pbmRleCgnYnktaWQnKVxuXHRcdFx0XHQuZ2V0QWxsKCk7XG5cdFx0fSkudGhlbihycmV2aWV3ID0+IHJyZXZpZXcpO1xuXHR9O1xuXG5cdC8qKiBUT0RPXG5cdCogSW1wbGVtZW50IFNvY2tldCB0byBsb2FkIHJlYWwgdGltZXMgZGF0YWJhc2UgbG9hZHNcblx0Ki9cblxuXHQvKipcblx0ICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50cyhjYWxsYmFjaykge1xuXHRcdHRoaXMubG9hZENhY2hlKCkudGhlbihkYXRhID0+IHtcblx0XHRcdGlmKGRhdGEubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCBkYXRhKTtcblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0ZmV0Y2godGhpcy5EQVRBQkFTRV9VUkwpLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0XHRcdGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuXHRcdFx0XHRcdFx0cmVzcG9uc2UuanNvbigpLnRoZW4oZGF0YSA9PiB7XG5cdFx0XHRcdFx0XHRcdHRoaXMuY2FjaGVEYXRhKGRhdGEpO1xuXHRcdFx0XHRcdFx0XHRjYWxsYmFjayhudWxsLCBkYXRhKTtcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJ2RhdGEgbG9hZGVkIGZyb20gbG9jYWwgc3RvcmFnZSEnKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjYWxsYmFjayh0aGlzLmhhbmRsZVJlc3BvbnNlRXJyb3IocmVzcG9uc2UsICdhcGkgcmVxdWVzdCcpLCBudWxsKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pLmNhdGNoKGVycm9yID0+IGNhbGxiYWNrKGVycm9yLCBudWxsKSk7XG5cblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIGNhbGxiYWNrKSB7XG5cdFx0Ly8gZmV0Y2ggYWxsIHJlc3RhdXJhbnRzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHRcdHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50cy5maW5kKHIgPT4gci5pZCA9PSBpZCk7XG5cblx0XHRcdFx0aWYgKHJlc3RhdXJhbnQpIHsgLy8gR290IHRoZSByZXN0YXVyYW50XG5cdFx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudCk7XG5cdFx0XHRcdH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXG5cdFx0XHRcdFx0Y2FsbGJhY2soJ1Jlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QnLCBudWxsKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZShjdWlzaW5lLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1x0d2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXG5cdFx0XHRcdGNvbnN0IHJlc3VsdHMgPSByZXN0YXVyYW50cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcblx0XHRcdFx0Y2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50QnlOZWlnaGJvcmhvb2QobmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xuXHRcdC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xuXHRcdHRoaXMuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XG5cdFx0XHRpZiAoZXJyb3IpIHtcblx0XHRcdFx0Y2FsbGJhY2soZXJyb3IsIG51bGwpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2Rcblx0XHRcdFx0Y29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIubmVpZ2hib3Job29kID09IG5laWdoYm9yaG9vZCk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxuXHQgKi9cblx0ZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kKGN1aXNpbmUsIG5laWdoYm9yaG9vZCwgY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxldCByZXN1bHRzID0gcmVzdGF1cmFudHM7XG5cdFx0XHRcdGlmIChjdWlzaW5lICE9ICdhbGwnKSB7IC8vIGZpbHRlciBieSBjdWlzaW5lXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG5laWdoYm9yaG9vZCAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXG5cdFx0XHRcdFx0cmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXHQvKipcblx0ICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdCAqL1xuXHRmZXRjaE5laWdoYm9yaG9vZHMoY2FsbGJhY2spIHtcblx0XHQvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcblx0XHR0aGlzLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xuXHRcdFx0aWYgKGVycm9yKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGVycm9yLCBudWxsKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xuXHRcdFx0XHRjb25zdCBuZWlnaGJvcmhvb2RzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2QpO1xuXHRcdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcblx0XHRcdFx0Y29uc3QgdW5pcXVlTmVpZ2hib3Job29kcyA9IG5laWdoYm9yaG9vZHMuZmlsdGVyKCh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaSk7XG5cdFx0XHRcdGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cdC8qKlxuXHQgKiBGZXRjaCBhbGwgY3Vpc2luZXMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXG5cdCAqL1xuXHRmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XG5cdFx0Ly8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXG5cdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcblx0XHRcdGlmIChlcnJvcikge1xuXHRcdFx0XHRjYWxsYmFjayhlcnJvciwgbnVsbCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBHZXQgYWxsIGN1aXNpbmVzIGZyb20gYWxsIHJlc3RhdXJhbnRzXG5cdFx0XHRcdGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpO1xuXHRcdFx0XHQvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIGN1aXNpbmVzXG5cdFx0XHRcdGNvbnN0IHVuaXF1ZUN1aXNpbmVzID0gY3Vpc2luZXMuZmlsdGVyKCh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGkpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCB1bmlxdWVDdWlzaW5lcyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblx0LyoqXG5cdCAqIFJlc3RhdXJhbnQgcGFnZSBVUkwuXG5cdCAqL1xuXHR1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcblx0XHRyZXR1cm4gKGAuL3Jlc3RhdXJhbnQuaHRtbD9pZD0ke3Jlc3RhdXJhbnQuaWR9YCk7XG5cdH1cblx0LyoqXG5cdCAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxuXHQgKi9cblx0aW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNpemUpIHtcblx0XHRsZXQgaW1nID0gcmVzdGF1cmFudC5waG90b2dyYXBoO1xuXHRcdHJldHVybiBpbWcgPyAoYC9pbWcvJHtpbWd9LSR7c2l6ZX0uanBnYCkgOiAnL2ltZy9yZXN0YXVyYW50X3BsYWNlaG9sZGVyLnN2Zyc7XG5cdH1cblx0LyoqXG5cdCAqIE1hcCBtYXJrZXIgZm9yIGEgcmVzdGF1cmFudC5cblx0ICovXG5cdG1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgbWFwKSB7XG5cdFx0Y29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG5cdFx0XHRwb3NpdGlvbjogcmVzdGF1cmFudC5sYXRsbmcsXG5cdFx0XHR0aXRsZTogcmVzdGF1cmFudC5uYW1lLFxuXHRcdFx0dXJsOiB0aGlzLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCksXG5cdFx0XHRtYXA6IG1hcCxcblx0XHRcdGFuaW1hdGlvbjogZ29vZ2xlLm1hcHMuQW5pbWF0aW9uLkRST1B9XG5cdFx0KTtcblx0XHRyZXR1cm4gbWFya2VyO1xuXHR9XG5cblx0aGFuZGxlUmVzcG9uc2VFcnJvcihyZXNwb25zZSwgdHlwZSl7XG5cdFx0c3dpdGNoIChyZXNwb25zZS5zdGF0dXMpIHtcblx0XHRcdGNhc2UgNDAwOlxuXHRcdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdCZWQgcmVxdWVzdCcpO1xuXHRcdFx0Y2FzZSA0MDQ6XG5cdFx0XHRcdHJldHVybiBuZXcgRXJyb3IoJ05vdCBmb3VuZCcpO1xuXHRcdFx0Y2FzZSA1MDA6IFxuXHRcdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InKTtcblx0XHR9XG5cdH1cblxufVxuIiwiaW1wb3J0IERCSGVscGVyIGZyb20gJy4vZGJoZWxwZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZXN0YXVyYW50SW5mbyB7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0dGhpcy5tYXAgPSBudWxsO1xuXHRcdHRoaXMucmVzdGF1cmFudCA9IG51bGw7XG5cdFx0dGhpcy5kYiA9IG5ldyBEQkhlbHBlcigpO1xuXG5cdFx0LyoqXG5cdFx0ICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuXHRcdCAqL1xuXHRcdHdpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xuXHRcdFx0dGhpcy5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuXHRcdFx0XHRpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGVycm9yKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG5cdFx0XHRcdFx0XHR6b29tOiAxNixcblx0XHRcdFx0XHRcdGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXG5cdFx0XHRcdFx0XHRzY3JvbGx3aGVlbDogZmFsc2Vcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR0aGlzLmZpbGxCcmVhZGNydW1iKCk7XG5cdFx0XHRcdFx0dGhpcy5kYi5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHRoaXMucmVzdGF1cmFudCwgdGhpcy5tYXApO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9O1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cblx0ICovXG5cdGZldGNoUmVzdGF1cmFudEZyb21VUkwoY2FsbGJhY2spIHtcblx0XHRpZiAodGhpcy5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxuXHRcdFx0Y2FsbGJhY2sobnVsbCwgdGhpcy5yZXN0YXVyYW50KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Y29uc3QgaWQgPSB0aGlzLmdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcblx0XHRpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuXHRcdFx0Y2FsbGJhY2soJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJywgbnVsbCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuZGIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG5cdFx0XHRcdHRoaXMucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG5cdFx0XHRcdGlmICghcmVzdGF1cmFudCkge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmZpbGxSZXN0YXVyYW50SFRNTCgpO1xuXHRcdFx0XHRjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fTtcblxuXHQvKipcblx0ICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG5cdCAqL1xuXHRmaWxsUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCA9IHRoaXMucmVzdGF1cmFudCkge1xuXHRcdGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XG5cdFx0bmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XG5cblx0XHRjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuXHRcdGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuXG5cdFx0Y29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcblx0XHRpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xuXHRcdGltYWdlLnNyYyA9IHRoaXMuZGIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIDYwMCk7XG5cdFx0aW1hZ2UuYWx0ID0gYFBob3RvIG9mICR7cmVzdGF1cmFudC5uYW1lfSByZXN0YXVyYW50YDtcblx0XHRpbWFnZS5zcmNzZXQgPSBgJHt0aGlzLmRiLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAxMjAwKX0gMTIwMHcsICR7dGhpcy5kYi5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgNjAwKX0gNjAwd2A7XG5cblx0XHRjb25zdCBjdWlzaW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtY3Vpc2luZScpO1xuXHRcdGN1aXNpbmUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5jdWlzaW5lX3R5cGU7XG5cblx0XHQvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuXHRcdGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuXHRcdFx0dGhpcy5maWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuXHRcdH1cblx0XHQvLyBmaWxsIHJldmlld3Ncblx0XHR0aGlzLmZpbGxSZXZpZXdzSFRNTCgpO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuXHQgKi9cblx0ZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwob3BlcmF0aW5nSG91cnMgPSB0aGlzLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSB7XG5cdFx0Y29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuXHRcdGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xuXHRcdFx0Y29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcblxuXHRcdFx0Y29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcblx0XHRcdGRheS5pbm5lckhUTUwgPSBrZXk7XG5cdFx0XHRyb3cuYXBwZW5kQ2hpbGQoZGF5KTtcblxuXHRcdFx0Y29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG5cdFx0XHR0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV07XG5cdFx0XHRyb3cuYXBwZW5kQ2hpbGQodGltZSk7XG5cblx0XHRcdGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG5cdFx0fVxuXHR9O1xuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG5cdCAqL1xuXHRmaWxsUmV2aWV3c0hUTUwocmV2aWV3cyA9IHRoaXMucmVzdGF1cmFudC5yZXZpZXdzKSB7XG5cdFx0Y29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XG5cdFx0Y29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMycpO1xuXHRcdHRpdGxlLmlubmVySFRNTCA9ICdSZXZpZXdzJztcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG5cdFx0aWYgKCFyZXZpZXdzKSB7XG5cdFx0XHRjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0XHRub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG5cdFx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Y29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG5cdFx0cmV2aWV3cy5mb3JFYWNoKHJldmlldyA9PiB7XG5cdFx0XHR1bC5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XG5cdFx0fSk7XG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcblx0fTtcblxuXHQvKipcblx0ICogQ3JlYXRlIHJldmlldyBIVE1MIGFuZCBhZGQgaXQgdG8gdGhlIHdlYnBhZ2UuXG5cdCAqL1xuXHRjcmVhdGVSZXZpZXdIVE1MKHJldmlldykge1xuXHRcdGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcblx0XHRjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRcdG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XG5cdFx0bGkuYXBwZW5kQ2hpbGQobmFtZSk7XG5cblx0XHRjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuXHRcdGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XG5cdFx0bGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XG5cblx0XHRjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG5cdFx0cmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xuXHRcdGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cblx0XHRjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcblx0XHRjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG5cdFx0bGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG5cdFx0cmV0dXJuIGxpO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuXHQgKi9cblx0ZmlsbEJyZWFkY3J1bWIocmVzdGF1cmFudD10aGlzLnJlc3RhdXJhbnQpIHtcblx0XHRjb25zdCBicmVhZGNydW1iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JyZWFkY3J1bWInKTtcblx0XHRjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cdFx0bGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXHRcdGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHJlc3RhdXJhbnQubmFtZSk7XG5cdFx0bGkuc2V0QXR0cmlidXRlKCdhcmlhLWN1cnJlbnQnLCAncGFnZScpO1xuXHRcdGJyZWFkY3J1bWIuYXBwZW5kQ2hpbGQobGkpO1xuXHR9O1xuXG5cdC8qKlxuXHQgKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuXHQgKi9cblx0Z2V0UGFyYW1ldGVyQnlOYW1lKG5hbWUsIHVybCkge1xuXHRcdGlmICghdXJsKVxuXHRcdFx0dXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XG5cdFx0bmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuXHRcdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuXHRcdFx0cmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcblx0XHRpZiAoIXJlc3VsdHMpXG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRpZiAoIXJlc3VsdHNbMl0pXG5cdFx0XHRyZXR1cm4gJyc7XG5cdFx0cmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcblx0fTtcblxufVxuXG53aW5kb3cucmVzdGF1cmFudEluZm8gPSBuZXcgUmVzdGF1cmFudEluZm8oKTtcblxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcmVxdWVzdDtcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHA7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpO1xuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Q2xhc3MucHJvdG90eXBlLCBwcm9wLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgdGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0uYXBwbHkodGhpc1t0YXJnZXRQcm9wXSwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcbiAgICB0aGlzLl9pbmRleCA9IGluZGV4O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ211bHRpRW50cnknLFxuICAgICd1bmlxdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdnZXQnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuICAgIHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuICAgICdkaXJlY3Rpb24nLFxuICAgICdrZXknLFxuICAgICdwcmltYXJ5S2V5JyxcbiAgICAndmFsdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuICAgICd1cGRhdGUnLFxuICAgICdkZWxldGUnXG4gIF0pO1xuXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG4gIFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICBpZiAoIShtZXRob2ROYW1lIGluIElEQkN1cnNvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGN1cnNvciA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICBmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xuICAgIHRoaXMuX3N0b3JlID0gc3RvcmU7XG4gIH1cblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuY3JlYXRlSW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnaW5kZXhOYW1lcycsXG4gICAgJ2F1dG9JbmNyZW1lbnQnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdwdXQnLFxuICAgICdhZGQnLFxuICAgICdkZWxldGUnLFxuICAgICdjbGVhcicsXG4gICAgJ2dldCcsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdkZWxldGVJbmRleCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuICAgIHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xuICAgICdvYmplY3RTdG9yZU5hbWVzJyxcbiAgICAnbW9kZSdcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFRyYW5zYWN0aW9uLCAnX3R4JywgSURCVHJhbnNhY3Rpb24sIFtcbiAgICAnYWJvcnQnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IG9sZFZlcnNpb247XG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gIH1cblxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnZGVsZXRlT2JqZWN0U3RvcmUnLFxuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gREIoZGIpIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICB9XG5cbiAgREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLl9kYi50cmFuc2FjdGlvbi5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKERCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xuICAvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXG4gIFsnb3BlbkN1cnNvcicsICdvcGVuS2V5Q3Vyc29yJ10uZm9yRWFjaChmdW5jdGlvbihmdW5jTmFtZSkge1xuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICAgIC8vIERvbid0IGNyZWF0ZSBpdGVyYXRlS2V5Q3Vyc29yIGlmIG9wZW5LZXlDdXJzb3IgZG9lc24ndCBleGlzdC5cbiAgICAgIGlmICghKGZ1bmNOYW1lIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblxuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICB1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbihkYikge1xuICAgICAgICByZXR1cm4gbmV3IERCKGRiKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xuICAgIH1cbiAgfTtcblxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cDtcbiAgICBtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XG4gIH1cbiAgZWxzZSB7XG4gICAgc2VsZi5pZGIgPSBleHA7XG4gIH1cbn0oKSk7XG4iXX0=\n"]}